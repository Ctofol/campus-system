{"version":3,"file":"register.js","sources":["pages/register/register.vue","E:/HBuilderX/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmVnaXN0ZXIvcmVnaXN0ZXIudnVl"],"sourcesContent":["<template>\n  <view class=\"register-container\">\n    <view class=\"header-section\">\n      <text class=\"title\">æ³¨å†Œæ–°è´¦å·</text>\n      <text class=\"sub-title\">åŠ å…¥æ ¡å›­è¿åŠ¨å¥åº·å¹³å°</text>\n    </view>\n\n    <view class=\"register-card\">\n      <!-- æ­¥éª¤1ï¼šè§’è‰²é€‰æ‹© -->\n      <view class=\"role-select-box\" v-if=\"step === 1\">\n        <text class=\"step-title\">è¯·é€‰æ‹©æ‚¨çš„èº«ä»½</text>\n        <view class=\"role-options\">\n          <view \n            class=\"role-option\" \n            :class=\"{active: registerForm.role === 'student'}\"\n            @click=\"selectRole('student')\"\n          >\n            <text class=\"role-icon\">ğŸ‘¨â€ğŸ“</text>\n            <text class=\"role-name\">æˆ‘æ˜¯å­¦ç”Ÿ</text>\n          </view>\n          <view \n            class=\"role-option\" \n            :class=\"{active: registerForm.role === 'teacher'}\"\n            @click=\"selectRole('teacher')\"\n          >\n            <text class=\"role-icon\">ğŸ‘¨â€ğŸ«</text>\n            <text class=\"role-name\">æˆ‘æ˜¯æ•™å¸ˆ</text>\n          </view>\n        </view>\n        <button class=\"next-btn\" @click=\"nextStep\">ä¸‹ä¸€æ­¥</button>\n      </view>\n\n      <!-- æ­¥éª¤2ï¼šä¿¡æ¯å¡«å†™ -->\n      <view class=\"form-box\" v-else>\n        <view class=\"form-header\">\n          <text class=\"back-text\" @click=\"step = 1\">è¿”å›ä¿®æ”¹èº«ä»½</text>\n          <text class=\"current-role\">å½“å‰èº«ä»½ï¼š{{ registerForm.role === 'student' ? 'å­¦ç”Ÿ' : 'æ•™å¸ˆ' }}</text>\n        </view>\n\n        <!-- åŸºç¡€ä¿¡æ¯ -->\n        <view class=\"section-title\">åŸºç¡€ä¿¡æ¯</view>\n        <view class=\"input-item\">\n          <input class=\"input\" v-model=\"registerForm.name\" placeholder=\"çœŸå®å§“å\" />\n        </view>\n        <view class=\"input-item\">\n          <input class=\"input\" v-model=\"registerForm.phone\" type=\"number\" placeholder=\"æ‰‹æœºå·ç \" />\n        </view>\n        <view class=\"input-item code-box\">\n          <input class=\"input\" v-model=\"registerForm.code\" type=\"number\" placeholder=\"éªŒè¯ç \" />\n          <text class=\"get-code\" @click=\"getCode\">è·å–éªŒè¯ç </text>\n        </view>\n        <view class=\"input-item\">\n          <input class=\"input\" v-model=\"registerForm.password\" type=\"password\" placeholder=\"è®¾ç½®å¯†ç  (6-16ä½)\" />\n        </view>\n        <view class=\"input-item\">\n          <input class=\"input\" v-model=\"registerForm.confirmPwd\" type=\"password\" placeholder=\"ç¡®è®¤å¯†ç \" />\n        </view>\n\n        <!-- èº«ä»½æ‰©å±•ä¿¡æ¯ -->\n        <view class=\"section-title\">èº«ä»½ä¿¡æ¯</view>\n        \n        <!-- å­¦ç”Ÿæ‰©å±•å­—æ®µ -->\n        <template v-if=\"registerForm.role === 'student'\">\n          <view class=\"input-item\">\n            <input class=\"input\" v-model=\"registerForm.school\" placeholder=\"å­¦æ ¡åç§°\" />\n          </view>\n          <view class=\"input-item\">\n            <input class=\"input\" v-model=\"registerForm.college\" placeholder=\"æ‰€å±å­¦é™¢\" />\n          </view>\n          <view class=\"input-item\">\n            <input class=\"input\" v-model=\"registerForm.major\" placeholder=\"ä¸“ä¸š\" />\n          </view>\n          <view class=\"input-item\">\n            <input class=\"input\" v-model=\"registerForm.class\" placeholder=\"ç­çº§ (å¦‚: 22çº§3ç­)\" />\n          </view>\n        </template>\n\n        <!-- æ•™å¸ˆæ‰©å±•å­—æ®µ -->\n        <template v-if=\"registerForm.role === 'teacher'\">\n          <view class=\"input-item\">\n            <input class=\"input\" v-model=\"registerForm.school\" placeholder=\"å­¦æ ¡åç§°\" />\n          </view>\n          <view class=\"input-item\">\n            <input class=\"input\" v-model=\"registerForm.empId\" placeholder=\"æ•™å¸ˆå·¥å·\" />\n          </view>\n          <view class=\"input-item\">\n            <input class=\"input\" v-model=\"registerForm.department\" placeholder=\"æ‰€å±éƒ¨é—¨ (å¦‚: è­¦ä½“æ•™ç ”å®¤)\" />\n          </view>\n        </template>\n\n        <!-- å­¦æ ¡ç±»å‹é€‚é… -->\n        <view class=\"police-switch-box\">\n          <view class=\"switch-header\">\n            <text class=\"switch-label\">è­¦æ ¡/å†›æ ¡ç”¨æˆ·</text>\n            <switch :checked=\"registerForm.isPoliceSchool\" @change=\"togglePolice\" color=\"#20C997\" style=\"transform:scale(0.8)\" />\n          </view>\n          <text class=\"switch-tip\" v-if=\"registerForm.isPoliceSchool\">\n            * å‹¾é€‰åï¼Œç³»ç»Ÿå°†å¼€å¯é€‚é…è­¦æ ¡/å†›æ ¡ä½“æµ‹æ ‡å‡†çš„ä¸“é¡¹è®­ç»ƒæ¨¡å—\n          </text>\n        </view>\n\n        <!-- æ³¨å†ŒæŒ‰é’® -->\n        <button class=\"submit-btn\" @click=\"handleRegister\" :loading=\"loading\">ç«‹å³æ³¨å†Œ</button>\n      </view>\n\n      <view class=\"footer-link\">\n        <text class=\"link-text\" @click=\"goToLogin\">å·²æœ‰è´¦å·ï¼Ÿè¿”å›ç™»å½•</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { register } from '@/utils/request.js';\n\nconst step = ref(1);\nconst loading = ref(false);\n\nconst registerForm = ref({\n  role: 'student', // student | teacher\n  name: '',\n  phone: '',\n  code: '',\n  password: '',\n  confirmPwd: '',\n  // æ‰©å±•\n  school: '',\n  college: '',\n  major: '',\n  class: '',\n  empId: '',\n  department: '',\n  isPoliceSchool: false\n});\n\nconst selectRole = (role) => {\n  registerForm.value.role = role;\n};\n\nconst nextStep = () => {\n  step.value = 2;\n};\n\nconst togglePolice = (e) => {\n  registerForm.value.isPoliceSchool = e.detail.value;\n};\n\nconst goToLogin = () => {\n  uni.navigateBack();\n};\n\nconst getCode = () => {\n  if (!registerForm.value.phone) {\n    uni.showToast({ title: 'è¯·å…ˆè¾“å…¥æ‰‹æœºå·', icon: 'none' });\n    return;\n  }\n  const phoneRegex = /^1[3-9]\\d{9}$/;\n  if (!phoneRegex.test(registerForm.value.phone)) {\n    uni.showToast({ title: 'æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®', icon: 'none' });\n    return;\n  }\n  \n  uni.showToast({ title: 'éªŒè¯ç å·²å‘é€', icon: 'success' });\n};\n\nconst handleRegister = async () => {\n  const form = registerForm.value;\n  \n  // åŸºç¡€éç©ºæ ¡éªŒ\n  if (!form.name || !form.phone || !form.password) {\n    uni.showToast({ title: 'è¯·å®Œå–„åŸºç¡€ä¿¡æ¯', icon: 'none' });\n    return;\n  }\n\n  // æ‰‹æœºå·æ ¼å¼æ ¡éªŒ\n  const phoneRegex = /^1[3-9]\\d{9}$/;\n  if (!phoneRegex.test(form.phone)) {\n    uni.showToast({ title: 'è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·', icon: 'none' });\n    return;\n  }\n\n  // å¯†ç é•¿åº¦æ ¡éªŒ\n  if (form.password.length < 6) {\n    uni.showToast({ title: 'å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½', icon: 'none' });\n    return;\n  }\n\n  // ç¡®è®¤å¯†ç æ ¡éªŒ\n  if (form.password !== form.confirmPwd) {\n    uni.showToast({ title: 'ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´', icon: 'none' });\n    return;\n  }\n  \n  // èº«ä»½æ ¡éªŒ\n  if (form.role === 'student' && (!form.school || !form.class)) {\n    uni.showToast({ title: 'è¯·å®Œå–„å­¦ç”Ÿä¿¡æ¯', icon: 'none' });\n    return;\n  }\n  if (form.role === 'teacher' && (!form.empId || !form.department)) {\n    uni.showToast({ title: 'è¯·å®Œå–„æ•™å¸ˆä¿¡æ¯', icon: 'none' });\n    return;\n  }\n\n  loading.value = true;\n  \n  try {\n    // è°ƒç”¨åç«¯æ³¨å†Œæ¥å£\n    // æ³¨æ„ï¼šåç«¯ç›®å‰MVPç‰ˆæœ¬åªæ¥æ”¶åŸºç¡€å­—æ®µï¼Œæ‰©å±•å­—æ®µï¼ˆschool, collegeç­‰ï¼‰æš‚æœªå­˜å‚¨\n    await register({\n        phone: form.phone,\n        name: form.name,\n        role: form.role,\n        password: form.password\n    });\n\n    uni.showToast({\n      title: 'æ³¨å†ŒæˆåŠŸ',\n      icon: 'success'\n    });\n    \n    // æ³¨å†ŒæˆåŠŸåè¿”å›ç™»å½•é¡µ\n    setTimeout(() => {\n      uni.navigateBack();\n    }, 1500);\n\n  } catch (error) {\n    console.error('Register failed:', error);\n    // é”™è¯¯å¤„ç†å·²åœ¨ request.js ä¸­åŒ…å«\n  } finally {\n    loading.value = false;\n  }\n};\n</script>\n\n<style scoped>\n.register-container {\n  min-height: 100vh;\n  background-color: #F5F7FA;\n  padding: 40rpx;\n  padding-top: 80rpx;\n}\n\n.header-section {\n  margin-bottom: 50rpx;\n}\n\n.title {\n  display: block;\n  font-size: 40rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 10rpx;\n}\n\n.sub-title {\n  font-size: 26rpx;\n  color: #999;\n}\n\n.register-card {\n  background: #fff;\n  border-radius: 24rpx;\n  padding: 40rpx;\n  box-shadow: 0 4rpx 20rpx rgba(0,0,0,0.05);\n}\n\n/* æ­¥éª¤1 */\n.step-title {\n  display: block;\n  font-size: 32rpx;\n  font-weight: bold;\n  text-align: center;\n  margin-bottom: 60rpx;\n}\n\n.role-options {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 60rpx;\n}\n\n.role-option {\n  width: 45%;\n  background: #F8F9FA;\n  border: 2rpx solid transparent;\n  border-radius: 16rpx;\n  padding: 40rpx 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  transition: all 0.3s;\n}\n\n.role-option.active {\n  background: #E3FDF5;\n  border-color: #20C997;\n}\n\n.role-icon {\n  font-size: 60rpx;\n  margin-bottom: 20rpx;\n}\n\n.role-name {\n  font-size: 28rpx;\n  color: #333;\n  font-weight: bold;\n}\n\n.role-option.active .role-name {\n  color: #20C997;\n}\n\n.next-btn {\n  background: #20C997;\n  color: #fff;\n  border-radius: 44rpx;\n  font-size: 30rpx;\n}\n\n/* æ­¥éª¤2 */\n.form-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 40rpx;\n  padding-bottom: 20rpx;\n  border-bottom: 1rpx solid #eee;\n}\n\n.back-text {\n  font-size: 24rpx;\n  color: #666;\n}\n\n.current-role {\n  font-size: 24rpx;\n  color: #20C997;\n  font-weight: bold;\n}\n\n.section-title {\n  font-size: 28rpx;\n  font-weight: bold;\n  color: #333;\n  margin: 30rpx 0 20rpx;\n  padding-left: 16rpx;\n  border-left: 6rpx solid #20C997;\n}\n\n.input-item {\n  margin-bottom: 24rpx;\n  background: #F8F9FA;\n  border-radius: 12rpx;\n  padding: 20rpx;\n}\n\n.input {\n  font-size: 28rpx;\n  color: #333;\n  width: 100%;\n}\n\n.code-box {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.get-code {\n  font-size: 24rpx;\n  color: #20C997;\n  padding: 10rpx 20rpx;\n  border-left: 1rpx solid #ddd;\n}\n\n.police-switch-box {\n  background: #F0F7FF;\n  padding: 20rpx;\n  border-radius: 12rpx;\n  margin: 40rpx 0;\n}\n\n.switch-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10rpx;\n}\n\n.switch-label {\n  font-size: 28rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.switch-tip {\n  font-size: 22rpx;\n  color: #666;\n  display: block;\n  line-height: 1.4;\n}\n\n.submit-btn {\n  background: linear-gradient(90deg, #20C997, #17a2b8);\n  color: #fff;\n  border-radius: 44rpx;\n  margin-top: 40rpx;\n  font-weight: bold;\n}\n\n.footer-link {\n  text-align: center;\n  margin-top: 40rpx;\n}\n\n.link-text {\n  font-size: 26rpx;\n  color: #666;\n}\n</style>\n","import MiniProgramPage from 'D:/PC/Document/HBuilderProjects/campus-system/fronted/pages/register/register.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","register"],"mappings":"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"}