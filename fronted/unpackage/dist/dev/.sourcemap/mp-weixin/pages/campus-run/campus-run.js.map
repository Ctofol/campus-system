{"version":3,"file":"campus-run.js","sources":["pages/campus-run/campus-run.vue","E:/HBuilderX/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2FtcHVzLXJ1bi9jYW1wdXMtcnVuLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"campus-run\">\n    <view v-if=\"!isRunning\" class=\"start-box\">\n      <text class=\"checkpoint-name\">打卡点：{{checkpoint.name}}</text>\n      <text class=\"tip\">需到达打卡点10米内，数据才有效</text>\n      <button @click=\"startRun\" class=\"start-btn\">开始前往打卡点</button>\n    </view>\n\n    <view v-else class=\"running-box\">\n      <view class=\"data\">\n        <text class=\"data-item\">时长：{{duration}}秒</text>\n        <text class=\"data-item\">距离打卡点：{{distanceToCheckpoint}}米</text>\n        <text class=\"data-item\" :style=\"{color: isReach ? 'green' : 'red'}\">\n          {{isReach ? '✅ 已到达打卡点' : '❌ 未到达打卡点'}}\n        </text>\n      </view>\n      <button @click=\"stopRun\" class=\"stop-btn\">结束打卡</button>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue';\n\n// 核心数据\nconst checkpoint = ref({});\nconst isRunning = ref(false);\nconst duration = ref(0);\nconst distanceToCheckpoint = ref(0);\nconst isReach = ref(false); // 是否到达打卡点\nlet timer = null;\nlet watcher = null;\n\n// 初始化打卡点\nonMounted(() => {\n  checkpoint.value = uni.getStorageSync('checkpoint');\n  if (!checkpoint.value) {\n    uni.navigateBack();\n    uni.showToast({ title: '未选择打卡点', icon: 'none' });\n  }\n});\n\n// 1. 开始跑步\nconst startRun = () => {\n  isRunning.value = true;\n  duration.value = 0;\n  isReach.value = false;\n\n  // 计时\n  timer = setInterval(() => {\n    duration.value += 1;\n    // 模拟距离打卡点的距离（递减）\n    distanceToCheckpoint.value = Math.max(0, 50 - duration.value / 2);\n    // 10米内算到达\n    isReach.value = distanceToCheckpoint.value <= 10;\n  }, 1000);\n\n  uni.showToast({ title: '开始打卡', icon: 'success' });\n};\n\n// 2. 结束打卡\nconst stopRun = () => {\n  clearInterval(timer);\n  isRunning.value = false;\n\n  // 跳转到结算页\n  uni.navigateTo({\n    url: `/pages/result/result?mode=campus&duration=${duration.value}&distance=${50 - distanceToCheckpoint.value}&isReach=${isReach.value}`\n  });\n};\n\n// 计算两点距离（备用，真实场景用）\nconst getDistance = (lat1, lng1, lat2, lng2) => {\n  const radLat1 = lat1 * Math.PI / 180;\n  const radLat2 = lat2 * Math.PI / 180;\n  const a = radLat1 - radLat2;\n  const b = lng1 * Math.PI / 180 - lng2 * Math.PI / 180;\n  let s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a/2),2) + Math.cos(radLat1)*Math.cos(radLat2)*Math.pow(Math.sin(b/2),2)));\n  s = s * 6378137;\n  return Math.round(s);\n};\n</script>\n\n<style scoped>\n.campus-run {\n  padding: 30rpx;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.start-box {\n  text-align: center;\n}\n.checkpoint-name {\n  font-size: 36rpx;\n  font-weight: bold;\n  margin-bottom: 10rpx;\n}\n.tip {\n  font-size: 28rpx;\n  color: #666;\n  margin-bottom: 30rpx;\n}\n.start-btn {\n  width: 600rpx;\n  height: 80rpx;\n  line-height: 80rpx;\n  background-color: #20C997;\n  color: #fff;\n  border: none;\n  border-radius: 10rpx;\n  font-size: 32rpx;\n}\n.running-box {\n  text-align: center;\n}\n.data {\n  margin-bottom: 30rpx;\n}\n.data-item {\n  display: block;\n  font-size: 36rpx;\n  margin: 10rpx 0;\n  color: #333;\n}\n.stop-btn {\n  width: 600rpx;\n  height: 80rpx;\n  line-height: 80rpx;\n  background-color: #d81e06;\n  color: #fff;\n  border: none;\n  border-radius: 10rpx;\n  font-size: 32rpx;\n}\n</style>","import MiniProgramPage from 'D:/PC/Document/HBuilderProjects/run-checkin/pages/campus-run/campus-run.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onMounted","uni"],"mappings":";;;;;AAyBA,UAAM,aAAaA,cAAAA,IAAI,CAAA,CAAE;AACzB,UAAM,YAAYA,cAAAA,IAAI,KAAK;AAC3B,UAAM,WAAWA,cAAAA,IAAI,CAAC;AACtB,UAAM,uBAAuBA,cAAAA,IAAI,CAAC;AAClC,UAAM,UAAUA,cAAAA,IAAI,KAAK;AACzB,QAAI,QAAQ;AAIZC,kBAAAA,UAAU,MAAM;AACd,iBAAW,QAAQC,cAAAA,MAAI,eAAe,YAAY;AAClD,UAAI,CAAC,WAAW,OAAO;AACrBA,sBAAG,MAAC,aAAY;AAChBA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,OAAM,CAAE;AAAA,MAChD;AAAA,IACH,CAAC;AAGD,UAAM,WAAW,MAAM;AACrB,gBAAU,QAAQ;AAClB,eAAS,QAAQ;AACjB,cAAQ,QAAQ;AAGhB,cAAQ,YAAY,MAAM;AACxB,iBAAS,SAAS;AAElB,6BAAqB,QAAQ,KAAK,IAAI,GAAG,KAAK,SAAS,QAAQ,CAAC;AAEhE,gBAAQ,QAAQ,qBAAqB,SAAS;AAAA,MAC/C,GAAE,GAAI;AAEPA,oBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,UAAS,CAAE;AAAA,IAClD;AAGA,UAAM,UAAU,MAAM;AACpB,oBAAc,KAAK;AACnB,gBAAU,QAAQ;AAGlBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,6CAA6C,SAAS,KAAK,aAAa,KAAK,qBAAqB,KAAK,YAAY,QAAQ,KAAK;AAAA,MACzI,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;ACpEA,GAAG,WAAW,eAAe;"}