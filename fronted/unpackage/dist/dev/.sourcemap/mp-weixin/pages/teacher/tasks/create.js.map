{"version":3,"file":"create.js","sources":["pages/teacher/tasks/create.vue","E:/HBuilderX/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGVhY2hlci90YXNrcy9jcmVhdGUudnVl"],"sourcesContent":["<template>\n  <view class=\"create-task-page\">\n    <view class=\"form-card\">\n      <view class=\"form-item\">\n        <text class=\"label\">任务标题</text>\n        <input class=\"input\" v-model=\"form.title\" placeholder=\"例如：本周5公里耐力跑\" />\n      </view>\n      <!-- 任务类型选择器 -->\n      <view class=\"form-item\">\n        <text class=\"label\">任务类型</text>\n        <picker mode=\"selector\" :range=\"taskTypeLabels\" @change=\"onTypeChange\">\n          <view class=\"picker-box\">\n            <text>{{ form.typeLabel || '请选择任务类型' }}</text>\n            <text class=\"arrow\">></text>\n          </view>\n        </picker>\n      </view>\n\n      <view class=\"form-item\">\n        <text class=\"label\">目标距离 (km)</text>\n        <input class=\"input\" type=\"digit\" v-model=\"form.distance\" placeholder=\"0.0\" />\n      </view>\n      \n      <view class=\"form-item\">\n        <text class=\"label\">截止日期</text>\n        <picker mode=\"date\" @change=\"onDateChange\">\n          <view class=\"picker-box\">\n            <text>{{ form.deadline || '请选择截止日期' }}</text>\n            <text class=\"arrow\">></text>\n          </view>\n        </picker>\n      </view>\n\n      <view class=\"form-item\">\n        <text class=\"label\">指派对象</text>\n        <picker mode=\"selector\" :range=\"groupLabels\" @change=\"onGroupChange\">\n          <view class=\"picker-box\">\n            <text>{{ form.targetLabel || '全员' }}</text>\n            <text class=\"arrow\">></text>\n          </view>\n        </picker>\n      </view>\n\n      <view class=\"form-item vertical\">\n        <text class=\"label\">任务说明</text>\n        <textarea class=\"textarea\" v-model=\"form.description\" placeholder=\"请输入任务的具体要求和注意事项...\" />\n      </view>\n    </view>\n\n    <view class=\"footer-btn\">\n      <button class=\"submit-btn\" @click=\"submitTask\">发布任务</button>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { createTeacherTask } from '@/utils/request.js';\n\nconst taskTypes = ['run', 'test']; // Simplified to match backend enum/string\nconst taskTypeLabels = ['跑步任务', '体能测试']; // Display labels\nconst groupOptions = ['all', 'group_a', 'group_b'];\nconst groupLabels = ['全员', '体能A组', '体能B组'];\n\nconst form = ref({\n  title: '',\n  type: '',\n  typeLabel: '',\n  distance: '',\n  deadline: '',\n  target: 'all',\n  targetLabel: '全员',\n  description: ''\n});\n\nconst onTypeChange = (e) => {\n  const index = e.detail.value;\n  form.value.type = taskTypes[index];\n  form.value.typeLabel = taskTypeLabels[index];\n};\n\nconst onDateChange = (e) => {\n  form.value.deadline = e.detail.value;\n};\n\nconst onGroupChange = (e) => {\n  const index = e.detail.value;\n  form.value.target = groupOptions[index];\n  form.value.targetLabel = groupLabels[index];\n};\n\nconst submitTask = async () => {\n  if (!form.value.title || !form.value.type || !form.value.deadline) {\n    return uni.showToast({ title: '请完善任务信息', icon: 'none' });\n  }\n  \n  uni.showLoading({ title: '发布中...' });\n  \n  try {\n    const payload = {\n      title: form.value.title,\n      type: form.value.type,\n      min_distance: form.value.type === 'run' ? Number(form.value.distance) : 0,\n      min_duration: 0,\n      min_count: 0,\n      deadline: new Date(form.value.deadline).toISOString(),\n      description: form.value.description,\n      target_group: form.value.target\n    };\n    \n    await createTeacherTask(payload);\n    \n    uni.hideLoading();\n    uni.showToast({ title: '任务发布成功', icon: 'success' });\n    \n    setTimeout(() => {\n      uni.navigateBack();\n    }, 1500);\n  } catch (e) {\n    uni.hideLoading();\n    console.error(e);\n  }\n};\n</script>\n\n<style scoped>\n.create-task-page {\n  min-height: 100vh;\n  background: #f8f8f8;\n  padding: 20rpx;\n  padding-bottom: 120rpx;\n}\n\n.form-card {\n  background: #fff;\n  border-radius: 12rpx;\n  padding: 0 30rpx;\n}\n\n.form-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 30rpx 0;\n  border-bottom: 1px solid #eee;\n}\n\n.form-item:last-child {\n  border-bottom: none;\n}\n\n.form-item.vertical {\n  flex-direction: column;\n  align-items: flex-start;\n  gap: 20rpx;\n}\n\n.label {\n  font-size: 30rpx;\n  color: #333;\n  width: 200rpx;\n}\n\n.input {\n  flex: 1;\n  text-align: right;\n  font-size: 30rpx;\n  color: #333;\n}\n\n.picker-box {\n  flex: 1;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  gap: 10rpx;\n  font-size: 30rpx;\n  color: #666;\n}\n\n.arrow {\n  color: #ccc;\n  font-size: 26rpx;\n}\n\n.textarea {\n  width: 100%;\n  height: 200rpx;\n  background: #f9f9f9;\n  padding: 20rpx;\n  border-radius: 8rpx;\n  font-size: 28rpx;\n  box-sizing: border-box;\n}\n\n.footer-btn {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  background: #fff;\n  padding: 20rpx 30rpx;\n  box-shadow: 0 -2rpx 10rpx rgba(0,0,0,0.05);\n  box-sizing: border-box;\n}\n\n.submit-btn {\n  background: #20C997;\n  color: #fff;\n  border-radius: 40rpx;\n  font-size: 32rpx;\n  font-weight: bold;\n}\n</style>","import MiniProgramPage from 'D:/PC/Document/HBuilderProjects/campus-system/fronted/pages/teacher/tasks/create.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","createTeacherTask"],"mappings":";;;;;;AA2DA,UAAM,YAAY,CAAC,OAAO,MAAM;AAChC,UAAM,iBAAiB,CAAC,QAAQ,MAAM;AACtC,UAAM,eAAe,CAAC,OAAO,WAAW,SAAS;AACjD,UAAM,cAAc,CAAC,MAAM,QAAQ,MAAM;AAEzC,UAAM,OAAOA,cAAAA,IAAI;AAAA,MACf,OAAO;AAAA,MACP,MAAM;AAAA,MACN,WAAW;AAAA,MACX,UAAU;AAAA,MACV,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,aAAa;AAAA,MACb,aAAa;AAAA,IACf,CAAC;AAED,UAAM,eAAe,CAAC,MAAM;AAC1B,YAAM,QAAQ,EAAE,OAAO;AACvB,WAAK,MAAM,OAAO,UAAU,KAAK;AACjC,WAAK,MAAM,YAAY,eAAe,KAAK;AAAA,IAC7C;AAEA,UAAM,eAAe,CAAC,MAAM;AAC1B,WAAK,MAAM,WAAW,EAAE,OAAO;AAAA,IACjC;AAEA,UAAM,gBAAgB,CAAC,MAAM;AAC3B,YAAM,QAAQ,EAAE,OAAO;AACvB,WAAK,MAAM,SAAS,aAAa,KAAK;AACtC,WAAK,MAAM,cAAc,YAAY,KAAK;AAAA,IAC5C;AAEA,UAAM,aAAa,YAAY;AAC7B,UAAI,CAAC,KAAK,MAAM,SAAS,CAAC,KAAK,MAAM,QAAQ,CAAC,KAAK,MAAM,UAAU;AACjE,eAAOC,cAAAA,MAAI,UAAU,EAAE,OAAO,WAAW,MAAM,OAAM,CAAE;AAAA,MACxD;AAEDA,oBAAAA,MAAI,YAAY,EAAE,OAAO,SAAU,CAAA;AAEnC,UAAI;AACF,cAAM,UAAU;AAAA,UACd,OAAO,KAAK,MAAM;AAAA,UAClB,MAAM,KAAK,MAAM;AAAA,UACjB,cAAc,KAAK,MAAM,SAAS,QAAQ,OAAO,KAAK,MAAM,QAAQ,IAAI;AAAA,UACxE,cAAc;AAAA,UACd,WAAW;AAAA,UACX,UAAU,IAAI,KAAK,KAAK,MAAM,QAAQ,EAAE,YAAa;AAAA,UACrD,aAAa,KAAK,MAAM;AAAA,UACxB,cAAc,KAAK,MAAM;AAAA,QAC/B;AAEI,cAAMC,cAAAA,kBAAkB,OAAO;AAE/BD,sBAAG,MAAC,YAAW;AACfA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,UAAS,CAAE;AAElD,mBAAW,MAAM;AACfA,wBAAG,MAAC,aAAY;AAAA,QACjB,GAAE,IAAI;AAAA,MACR,SAAQ,GAAG;AACVA,sBAAG,MAAC,YAAW;AACfA,sBAAAA,MAAc,MAAA,SAAA,yCAAA,CAAC;AAAA,MAChB;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;ACzHA,GAAG,WAAW,eAAe;"}