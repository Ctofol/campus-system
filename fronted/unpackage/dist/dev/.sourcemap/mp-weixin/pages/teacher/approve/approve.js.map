{"version":3,"file":"approve.js","sources":["pages/teacher/approve/approve.vue","E:/HBuilderX/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGVhY2hlci9hcHByb3ZlL2FwcHJvdmUudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"header\">\n      <text class=\"title\">待审批活动</text>\n    </view>\n    <scroll-view scroll-y class=\"list\">\n      <view class=\"item\" v-for=\"item in activities\" :key=\"item.id\" @click=\"goToDetail(item)\">\n        <view class=\"info\">\n          <text class=\"name\">{{ item.student_name }}</text>\n          <text class=\"desc\">{{ item.type === 'run' ? '跑步' : '体测' }} - {{ item.metrics?.distance ? Number(item.metrics.distance).toFixed(2) : 0 }}km</text>\n          <text class=\"time\">{{ new Date(item.started_at).toLocaleString() }}</text>\n        </view>\n        <button class=\"btn\" @click.stop=\"handleApprove(item.id)\" :disabled=\"item.status === 'approved' || item.status === 'completed'\" :style=\"{ backgroundColor: (item.status === 'approved' || item.status === 'completed') ? '#ccc' : '#20C997' }\">\n          {{ (item.status === 'approved' || item.status === 'completed') ? '已通过' : '通过' }}\n        </button>\n      </view>\n      <view v-if=\"activities.length === 0\" class=\"empty\">暂无待审批活动</view>\n    </scroll-view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { onShow } from '@dcloudio/uni-app';\nimport { getTeacherActivities, approveActivity } from '@/utils/request.js';\n\nconst activities = ref([]);\n\nconst loadData = async () => {\n  try {\n    const res = await getTeacherActivities({ page: 1, size: 20 });\n    if (res && res.items) {\n      activities.value = res.items;\n    }\n  } catch (e) {\n    console.error(e);\n    uni.showToast({ title: '加载待审批活动失败', icon: 'none' });\n  }\n};\n\nconst handleApprove = async (id) => {\n  try {\n    await approveActivity(id);\n    uni.showToast({ title: '审批成功' });\n    loadData(); // Reload\n  } catch (e) {\n    console.error(e);\n    uni.showToast({ title: '审批失败，请稍后重试', icon: 'none' });\n  }\n};\n\nconst goToDetail = (item) => {\n  // Navigate to student detail page with student ID\n  uni.navigateTo({\n    url: `/pages/teacher/approve/student-detail?studentId=${item.user_id}&studentName=${item.student_name}`\n  });\n};\n\nonShow(() => {\n  loadData();\n});\n</script>\n\n<style>\n.container { padding: 20rpx; background-color: #f5f7fa; min-height: 100vh; }\n.header { margin-bottom: 20rpx; font-weight: bold; font-size: 32rpx; padding: 10rpx 0; }\n.item { display: flex; justify-content: space-between; align-items: center; background: #fff; padding: 30rpx; margin-bottom: 20rpx; border-radius: 12rpx; box-shadow: 0 2rpx 6rpx rgba(0,0,0,0.05); }\n.info { display: flex; flex-direction: column; }\n.name { font-weight: bold; font-size: 30rpx; margin-bottom: 8rpx; }\n.desc { color: #666; font-size: 26rpx; margin-bottom: 8rpx; }\n.time { color: #999; font-size: 22rpx; }\n.btn { font-size: 24rpx; color: #fff; padding: 0 30rpx; height: 60rpx; line-height: 60rpx; border-radius: 30rpx; }\n.empty { text-align: center; color: #999; margin-top: 100rpx; font-size: 28rpx; }\n</style>\n","import MiniProgramPage from 'D:/PC/Document/HBuilderProjects/campus-system/fronted/pages/teacher/approve/approve.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","getTeacherActivities","uni","approveActivity","onShow","MiniProgramPage"],"mappings":";;;;;;AA0BA,UAAM,aAAaA,cAAAA,IAAI,CAAA,CAAE;AAEzB,UAAM,WAAW,YAAY;AAC3B,UAAI;AACF,cAAM,MAAM,MAAMC,cAAAA,qBAAqB,EAAE,MAAM,GAAG,MAAM,GAAE,CAAE;AAC5D,YAAI,OAAO,IAAI,OAAO;AACpB,qBAAW,QAAQ,IAAI;AAAA,QACxB;AAAA,MACF,SAAQ,GAAG;AACVC,sBAAAA,MAAc,MAAA,SAAA,2CAAA,CAAC;AACfA,sBAAG,MAAC,UAAU,EAAE,OAAO,aAAa,MAAM,OAAM,CAAE;AAAA,MACnD;AAAA,IACH;AAEA,UAAM,gBAAgB,OAAO,OAAO;AAClC,UAAI;AACF,cAAMC,cAAAA,gBAAgB,EAAE;AACxBD,sBAAAA,MAAI,UAAU,EAAE,OAAO,OAAQ,CAAA;AAC/B;MACD,SAAQ,GAAG;AACVA,sBAAAA,MAAc,MAAA,SAAA,2CAAA,CAAC;AACfA,sBAAG,MAAC,UAAU,EAAE,OAAO,cAAc,MAAM,OAAM,CAAE;AAAA,MACpD;AAAA,IACH;AAEA,UAAM,aAAa,CAAC,SAAS;AAE3BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,mDAAmD,KAAK,OAAO,gBAAgB,KAAK,YAAY;AAAA,MACzG,CAAG;AAAA,IACH;AAEAE,kBAAAA,OAAO,MAAM;AACX;IACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;AC3DD,GAAG,WAAWC,SAAe;"}