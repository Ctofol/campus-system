{"version":3,"file":"run.js","sources":["pages/run/run.vue","E:/HBuilderX/HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcnVuL3J1bi52dWU"],"sourcesContent":["<template>\n  <view class=\"run\">\n    <!-- AI Robot Component -->\n    <ai-chat-robot \n      v-model:visible=\"showAiRobot\" \n      :run-data=\"currentRunData\"\n      @share=\"handleShareToTeacher\"\n    />\n    \n    <!-- AI Robot Float Button -->\n    <view class=\"ai-float-btn\" @click=\"openAiRobot\" v-if=\"isRunning || distance > 0\">\n      <text class=\"ai-btn-icon\">ü§ñ</text>\n      <text class=\"ai-btn-text\">AIÂä©Êâã</text>\n    </view>\n\n    <!-- 0. È°∂ÈÉ®Â§©Ê∞î‰∏éÊàêÂ∞±ÔºàÊñ∞Â¢ûÔºâ -->\n    <view class=\"top-widgets\">\n      <view class=\"weather-widget\">\n        <view class=\"weather-left\">\n          <text class=\"weather-temp\">24¬∞C</text>\n          <text class=\"weather-status\">‚òÄÔ∏è Êô¥Êúó</text>\n        </view>\n        <view class=\"weather-right\">\n          <text class=\"weather-tips\">Á©∫Ê∞î‰ºò ¬∑ ÈÄÇÂÆúË∑ëÊ≠•</text>\n        </view>\n      </view>\n      <scroll-view scroll-x class=\"achievements-scroll\" :show-scrollbar=\"false\">\n        <view class=\"badge-item\" v-for=\"(badge, idx) in achievements\" :key=\"idx\">\n          <text class=\"badge-icon\">{{ badge.icon }}</text>\n          <text class=\"badge-name\">{{ badge.name }}</text>\n        </view>\n      </scroll-view>\n    </view>\n\n    <!-- 1. ÊêúÁ¥¢ÊâìÂç°ÁÇπÔºà‰ªÖÊ†°Âõ≠ÊâìÂç°Áî®Ôºâ -->\n    <view class=\"search-bar\" v-if=\"currentMode === 'campus'\">\n      <input \n        v-model=\"checkpointName\" \n        placeholder=\"ËæìÂÖ•Ê†°Âõ≠ÊâìÂç°ÁÇπÔºàÂ¶ÇÔºöÊìçÂú∫/Ë∑ëÈÅìÔºâ\"\n        class=\"search-input\"\n      />\n      <button @click=\"searchCheckpoint\" class=\"search-btn\">ÊêúÁ¥¢</button>\n    </view>\n\n    <!-- 2. Âú∞ÂõæÂ±ïÁ§∫ -->\n    <view class=\"overview-card\">\n      <text class=\"overview-title\">‰ªäÊó•Ë∑ëÊ≠•Ê¶ÇËßà</text>\n      <view class=\"overview-meta\">\n        <text>Ê¨°Êï∞Ôºö{{ todayRunCount }}</text>\n        <text>ÈáåÁ®ãÔºö{{ todayRunDistance }} km</text>\n      </view>\n      <text v-if=\"teacherRunTask\" class=\"task-tip\">ÊïôÂ∏à‰ªªÂä°Ôºö{{ teacherRunTask }}</text>\n    </view>\n    <map \n      class=\"map\" \n      :latitude=\"lat\" \n      :longitude=\"lng\" \n      :markers=\"markers\"\n      :polyline=\"polyline\"\n    ></map>\n\n    <!-- 2.5 Êé®ËçêË∑ØÁ∫øÔºàÊñ∞Â¢ûÔºâ -->\n    <view class=\"routes-card\" v-if=\"currentMode === 'normal'\">\n      <view class=\"card-header\" @click=\"toggleRoutes\">\n        <text class=\"card-title\">üèÉ Êé®ËçêË∑ØÁ∫ø</text>\n        <text class=\"card-toggle\">{{ showRoutes ? 'Êî∂Ëµ∑' : 'Â±ïÂºÄ' }}</text>\n      </view>\n      <view class=\"routes-list\" v-if=\"showRoutes\">\n        <view class=\"route-item\" v-for=\"(route, idx) in recommendRoutes\" :key=\"idx\" @click=\"useRoute(route)\">\n          <view class=\"route-info\">\n            <text class=\"route-name\">{{ route.name }}</text>\n            <text class=\"route-meta\">{{ route.distance }}km ¬∑ {{ route.difficulty }}</text>\n          </view>\n          <text class=\"route-action\">ÂéªË∑ëÊ≠• ></text>\n        </view>\n      </view>\n    </view>\n\n    <!-- 3. Ê†∏ÂøÉË∑ëÊ≠•Ê®°ÂºèÂàáÊç¢ÔºàÊôÆÈÄö/‰∏ìÈ°π/Ê†°Âõ≠Ôºå‰∏âÈÄâ‰∏ÄÔºâ -->\n    <view class=\"mode-switch\">\n      <text class=\"mode-item\" :class=\"{active: currentMode === 'normal'}\" @click=\"switchMode('normal')\">ÊôÆÈÄöË∑ëÊ≠•</text>\n      <text class=\"mode-item\" :class=\"{active: currentMode === 'police'}\" @click=\"switchMode('police')\">‰∏ìÈ°πÊµãËØï</text>\n      <text class=\"mode-item\" :class=\"{active: currentMode === 'campus'}\" @click=\"switchMode('campus')\">Ê†°Âõ≠ÊâìÂç°</text>\n    </view>\n\n    <!-- 4. ‰∏ìÈ°πÊµãËØïËÆ°ÂàíÔºàÁã¨Á´ãÊ®°ÂùóÔºå‰ªÖ‰∏ìÈ°πÊ®°ÂºèÊòæÁ§∫Ôºâ -->\n    <view v-if=\"currentMode === 'police'\" class=\"police-plan\">\n      <text class=\"plan-title\">üéØ 2000Á±≥‰ΩìËÉΩ‰∏ìÈ°πËÆ≠ÁªÉ</text>\n      <view class=\"plan-info\">\n        <text class=\"info-item\">ÁõÆÊ†áË∑ùÁ¶ªÔºö<span class=\"highlight\">{{policeTargetDistance/1000}}ÂÖ¨Èáå</span></text>\n        <text class=\"info-item\">ËææÊ†áÈÖçÈÄüÔºö<span class=\"highlight\">{{policeTargetPace}}ÂàÜÈíü/ÂÖ¨Èáå</span></text>\n        <text class=\"info-item\">Âª∫ËÆÆÊ†áÂáÜÔºö<span class=\"highlight\">ÂèØÊåâÂ≠¶Ê†°ÊàñËØæÁ®ãË¶ÅÊ±ÇÈÖçÁΩÆ</span></text>\n      </view>\n    </view>\n\n    <!-- 5. ÊôÆÈÄöË∑ëÊ≠• -->\n    <view v-if=\"currentMode === 'normal'\" class=\"run-mode-box\">\n      <view v-if=\"!isRunning\" class=\"start-box\">\n        <text class=\"tip\">Êó†Âú∞ÁÇπ/Ë∑ùÁ¶ªÈôêÂà∂ÔºåËá™Áî±ËÆ∞ÂΩïË∑ëÊ≠•ËΩ®Ëøπ</text>\n        <button @click=\"startNormalRun\" class=\"start-btn\">ÂºÄÂßãË∑ëÊ≠•</button>\n      </view>\n      <view v-else class=\"running-box\">\n        <text class=\"data\">Êó∂ÈïøÔºö{{duration}}Áßí | Â∑≤Ë∑ëÔºö{{(distance/1000).toFixed(2)}}km | ÈÄüÂ∫¶Ôºö{{currentSpeedKmh}}km/h</text>\n        <text class=\"data\">Ê≠•Êï∞Ôºö{{stepCount}} | ÂøÉÁéáÔºö{{heartRate}}Ê¨°/ÂàÜ | Âπ≥ÂùáÈÄüÂ∫¶Ôºö{{avgSpeedKmh}}km/h</text>\n        <view class=\"progress-wrap\">\n          <view class=\"progress-bar\"><view class=\"progress-fill\" :style=\"{width: normalProgress + '%'}\"></view></view>\n          <text class=\"progress-text\">‰ªäÊó•ÁõÆÊ†á {{dailyTarget}} km ¬∑ ÂÆåÊàê {{(distance/1000).toFixed(2)}} km</text>\n        </view>\n        <button @click=\"stopRun\" class=\"stop-btn\">ÁªìÊùüË∑ëÊ≠•</button>\n      </view>\n    </view>\n\n    <!-- 6. ‰∏ìÈ°πË∑ëÊ≠•ÔºàÊåâ2000Á±≥ÁõÆÊ†áË∑ëÔºâ -->\n    <view v-if=\"currentMode === 'police'\" class=\"run-mode-box\">\n      <view v-if=\"!isRunning\" class=\"start-box\">\n        <text class=\"tip\">ÊåâËØæÁ®ãË¶ÅÊ±ÇÂÆåÊàê2000Á±≥Ë∑ëÔºåËá™Âä®Ê†°È™åÈÖçÈÄüÊòØÂê¶ËææÊ†á</text>\n        <button @click=\"startPoliceRun\" class=\"start-btn\">ÂºÄÂßã‰∏ìÈ°πËÆ≠ÁªÉ</button>\n      </view>\n      <view v-else class=\"running-box\">\n        <text class=\"data\">Êó∂ÈïøÔºö{{duration}}Áßí | Â∑≤Ë∑ëÔºö{{(distance/1000).toFixed(2)}}km / ÁõÆÊ†áÔºö2km</text>\n        <text class=\"data\">Ââ©‰ΩôÔºö{{((policeTargetDistance - distance)/1000).toFixed(2)}}km | ÈÖçÈÄüÔºö{{currentPace.toFixed(1)}}ÂàÜÈíü/ÂÖ¨Èáå</text>\n        <text class=\"data\">ÂøÉÁéáÔºö{{heartRate}}Ê¨°/ÂàÜ | Ê≠•Êï∞Ôºö{{stepCount}}</text>\n        <text class=\"pace-status\" :style=\"{color: currentPace <= policeTargetPace ? 'green' : 'red'}\">\n          {{currentPace <= policeTargetPace ? '‚úÖ ÈÖçÈÄüËææÊ†á' : '‚ùå ÈÖçÈÄüÊú™ËææÊ†á'}}\n        </text>\n        <!-- ËææÂà∞ÁõÆÊ†áË∑ùÁ¶ªËá™Âä®ÊèêÁ§∫ -->\n        <text class=\"finish-tip\" v-if=\"distance >= policeTargetDistance\">üéâ Â∑≤ÂÆåÊàê2000Á±≥ÁõÆÊ†áÔºÅ</text>\n        <view class=\"progress-wrap\">\n          <view class=\"progress-bar\"><view class=\"progress-fill\" :style=\"{width: policeProgress + '%'}\"></view></view>\n          <text class=\"progress-text\">‰∏ìÈ°πÁõÆÊ†á 2 km ¬∑ ÂÆåÊàê {{(distance/1000).toFixed(2)}} km</text>\n        </view>\n        <button @click=\"stopRun\" class=\"stop-btn\">ÁªìÊùüËÆ≠ÁªÉ</button>\n      </view>\n    </view>\n\n    <!-- 7. Ê†°Âõ≠ÊâìÂç° -->\n    <view v-if=\"currentMode === 'campus'\" class=\"run-mode-box\">\n      <view v-if=\"!checkpoint.name\" class=\"no-checkpoint\">\n        <text class=\"tip\">ËØ∑ÂÖàÊêúÁ¥¢Ê†°Âõ≠ÊâìÂç°ÁÇπ</text>\n      </view>\n      <view v-else>\n        <view v-if=\"!isRunning\" class=\"start-box\">\n          <text class=\"checkpoint-info\">ÊâìÂç°ÁÇπÔºö{{checkpoint.name}}ÔºàÈúÄÂà∞Ëææ10Á±≥ÂÜÖÔºâ</text>\n          <button @click=\"startCampusRun\" class=\"start-btn\">ÂºÄÂßãÊâìÂç°</button>\n        </view>\n        <view v-else class=\"running-box\">\n          <text class=\"data\">Êó∂ÈïøÔºö{{duration}}Áßí | Ë∑ùÊâìÂç°ÁÇπÔºö{{distanceToCheckpoint}}Á±≥ | Ê≠•Êï∞Ôºö{{stepCount}} | ÂøÉÁéáÔºö{{heartRate}}Ê¨°/ÂàÜ</text>\n          <text class=\"reach-status\" :style=\"{color: isReach ? 'green' : 'red'}\">\n            {{isReach ? '‚úÖ Â∑≤Âà∞ËææÊâìÂç°ÁÇπ' : '‚ùå Êú™Âà∞ËææÊâìÂç°ÁÇπ'}}\n          </text>\n          <button @click=\"stopRun\" class=\"stop-btn\">ÁªìÊùüÊâìÂç°</button>\n        </view>\n      </view>\n    </view>\n    \n    <!-- Â∫ïÈÉ®ÂØºËà™Ê†è -->\n    <CustomTabBar current=\"/pages/run/run\" />\n  </view>\n</template>\n\n<script setup>\n// Áªü‰∏ÄÂØºÂÖ•ËßÑËåÉ\nimport { ref, computed, onUnmounted } from 'vue';\nimport { onShow, onLoad } from '@dcloudio/uni-app';\nimport AiChatRobot from '@/components/ai-chat-robot/ai-chat-robot.vue';\nimport CustomTabBar from '@/components/CustomTabBar/CustomTabBar.vue';\nimport { submitActivity, getCheckpoints, checkIn } from '@/utils/request.js';\n\n// ÁªÑ‰ª∂Âç∏ËΩΩÊó∂Ê∏ÖÁêÜÂÆöÊó∂Âô®\nonUnmounted(() => {\n  if (timer) clearInterval(timer);\n  stopStepCount();\n});\n\n// AI Robot Logic\nconst showAiRobot = ref(false);\nconst currentRunData = computed(() => ({\n  distance: distance.value,\n  pace: currentPace.value || (distance.value > 0 ? (duration.value/60)/(distance.value/1000) : 0),\n  heartRate: heartRate.value,\n  stepCount: stepCount.value\n}));\n\nconst openAiRobot = () => {\n  showAiRobot.value = true;\n};\n\nconst handleShareToTeacher = (card) => {\n  // Save shared report to storage for teacher to see (mock)\n  const report = {\n    studentName: uni.getStorageSync('userInfo')?.name || 'Â≠¶Âëò',\n    time: new Date().toLocaleString(),\n    card: card\n  };\n  // In a real app, this would be an API call. \n  // Here we mock it by saving to a global list that teacher page reads.\n  let sharedReports = uni.getStorageSync('mockSharedReports') || [];\n  sharedReports.unshift(report);\n  uni.setStorageSync('mockSharedReports', sharedReports);\n};\n\n// Ê¶ÇËßà‰∏é‰ªªÂä°ÊèêÁ§∫\nconst todayRunCount = ref(0);\nconst todayRunDistance = ref(0);\nconst teacherRunTask = ref('');\nconst dailyTarget = ref(5);\nconst normalProgress = ref(0);\nconst policeProgress = ref(0);\nconst historyList = ref([]);\n\n// Êñ∞Â¢ûÊï∞ÊçÆ\nconst achievements = ref([\n  { name: 'ÂàùÊ¨°ÂºÄË∑ë', icon: 'üèÖ' },\n  { name: '‰∫îÂÖ¨ÈáåËææ‰∫∫', icon: 'üèÉ‚Äç‚ôÇÔ∏è' },\n  { name: 'ÂÖ®Âã§Âë®', icon: 'üî•' },\n  { name: 'Êó©Ëµ∑È∏ü', icon: 'üê¶' }\n]);\nconst showRoutes = ref(false);\nconst recommendRoutes = ref([\n  { name: 'ÁéØÊ†°Â§ñÂúàË∑ë', distance: 5.2, difficulty: '‰∏≠Á≠â' },\n  { name: 'ÊπñÁïîÊûóËç´ÈÅì', distance: 3.0, difficulty: 'ÁÆÄÂçï' },\n  { name: '‰ΩìËÇ≤Âú∫ÂÜ≤Âà∫', distance: 1.5, difficulty: 'Âõ∞Èöæ' }\n]);\nconst toggleRoutes = () => showRoutes.value = !showRoutes.value;\nconst useRoute = (route) => {\n  uni.showToast({ title: `Â∑≤Âä†ËΩΩË∑ØÁ∫øÔºö${route.name}`, icon: 'none' });\n  dailyTarget.value = route.distance;\n};\n\n// 1. Âú∞Âõæ/ÊâìÂç°ÁÇπÊï∞ÊçÆ\nconst checkpointName = ref('');\nconst lat = ref(39.909);\nconst lng = ref(116.397);\nconst markers = ref([]);\nconst polyline = ref([{ points: [], color: '#007AFF', width: 4 }]);\nconst checkpoint = ref({});\nconst trajectoryPoints = ref([]); // Store real GPS points\nconst checkinRecords = ref([]); // Store successful check-ins\n\n// Distance Calculation (Haversine Formula)\nconst getDistance = (lat1, lng1, lat2, lng2) => {\n  const R = 6371e3; // Earth radius in meters\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLng = (lng2 - lng1) * Math.PI / 180;\n  const a = Math.sin(dLat/2) * Math.sin(dLat/2) +\n            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n            Math.sin(dLng/2) * Math.sin(dLng/2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n  return R * c; // Distance in meters\n};\n\n// Real-time Location Tracking\nconst startRealLocationTracking = () => {\n  // #ifdef H5\n  if (h5LocationTimer) clearInterval(h5LocationTimer);\n  let lastTs = Date.now();\n  h5LocationTimer = setInterval(() => {\n    uni.getLocation({\n      type: 'gcj02',\n      accuracy: 'high',\n      success: (res) => {\n        const newLat = res.latitude;\n        const newLng = res.longitude;\n        lat.value = newLat;\n        lng.value = newLng;\n        markers.value[0] = {\n          id: 0,\n          latitude: newLat,\n          longitude: newLng,\n          title: 'ÊàëÁöÑ‰ΩçÁΩÆ',\n          iconPath: '/static/location.png',\n          width: 30,\n          height: 30\n        };\n        if (isRunning.value) {\n          let speedVal = 0;\n          if (trajectoryPoints.value.length > 0) {\n            const lastPoint = trajectoryPoints.value[trajectoryPoints.value.length - 1];\n            const d = getDistance(lastPoint.latitude, lastPoint.longitude, newLat, newLng);\n            const dt = (Date.now() - lastTs) / 1000;\n            if (d > 2 && d < 100 && dt > 0) {\n              distance.value += d;\n              speedVal = d / dt;\n            }\n          }\n          currentSpeed.value = speedVal;\n          const point = { latitude: newLat, longitude: newLng, timestamp: Date.now(), speed: currentSpeed.value };\n          trajectoryPoints.value.push(point);\n          polyline.value[0].points.push({ latitude: newLat, longitude: newLng });\n          if (currentMode.value === 'campus' && checkpoint.value.lat) {\n            distanceToCheckpoint.value = Math.floor(getDistance(newLat, newLng, checkpoint.value.lat, checkpoint.value.lng));\n            if (distanceToCheckpoint.value <= (checkpoint.value.radius || 50)) { \n              isReach.value = true;\n              if (!uni.getStorageSync('checkpointReached')) {\n                 if (checkpoint.value.id) {\n                   checkIn({ lat: newLat, lng: newLng, checkpoint_id: checkpoint.value.id })\n                     .then(res => {\n                       if (res.success) {\n                         uni.showToast({ title: 'ÊâìÂç°ÊàêÂäüÔºÅ', icon: 'success' });\n                         checkinRecords.value.push({ checkpoint_id: checkpoint.value.id, time: new Date().toISOString(), lat: newLat, lng: newLng });\n                       }\n                     }).catch(() => {});\n                 } else {\n                    uni.showToast({ title: 'Â∑≤Âà∞ËææÊâìÂç°ÁÇπËåÉÂõ¥ÔºÅ', icon: 'success' });\n                 }\n                 uni.setStorageSync('checkpointReached', '1');\n              }\n            } else {\n              isReach.value = false;\n            }\n          }\n          if (currentMode.value === 'normal') {\n             normalProgress.value = Math.min(100, ((distance.value/1000) / dailyTarget.value) * 100);\n          } else if (currentMode.value === 'police') {\n             policeProgress.value = Math.min(100, (distance.value / policeTargetDistance.value) * 100);\n          }\n          lastTs = Date.now();\n        }\n      },\n      fail: () => {}\n    });\n  }, 1000);\n  // #endif\n  // #ifndef H5\n  uni.startLocationUpdate({\n    success: () => {\n      uni.onLocationChange((res) => {\n        const newLat = res.latitude;\n        const newLng = res.longitude;\n        lat.value = newLat;\n        lng.value = newLng;\n        if (res.speed && res.speed >= 0) {\n          currentSpeed.value = res.speed;\n        }\n        markers.value[0] = {\n          id: 0,\n          latitude: newLat,\n          longitude: newLng,\n          title: 'ÊàëÁöÑ‰ΩçÁΩÆ',\n          iconPath: '/static/location.png',\n          width: 30,\n          height: 30\n        };\n        if (isRunning.value) {\n          if (trajectoryPoints.value.length > 0) {\n            const lastPoint = trajectoryPoints.value[trajectoryPoints.value.length - 1];\n            const d = getDistance(lastPoint.latitude, lastPoint.longitude, newLat, newLng);\n            if (d > 2 && d < 100) { \n              distance.value += d;\n            }\n          }\n          const point = { latitude: newLat, longitude: newLng, timestamp: Date.now(), speed: currentSpeed.value };\n          trajectoryPoints.value.push(point);\n          polyline.value[0].points.push({ latitude: newLat, longitude: newLng });\n          if (currentMode.value === 'campus' && checkpoint.value.lat) {\n            distanceToCheckpoint.value = Math.floor(getDistance(newLat, newLng, checkpoint.value.lat, checkpoint.value.lng));\n            if (distanceToCheckpoint.value <= (checkpoint.value.radius || 50)) { \n              isReach.value = true;\n              if (!uni.getStorageSync('checkpointReached')) {\n                 if (checkpoint.value.id) {\n                   checkIn({ lat: newLat, lng: newLng, checkpoint_id: checkpoint.value.id })\n                     .then(res => {\n                       if (res.success) {\n                         uni.showToast({ title: 'ÊâìÂç°ÊàêÂäüÔºÅ', icon: 'success' });\n                         checkinRecords.value.push({ checkpoint_id: checkpoint.value.id, time: new Date().toISOString(), lat: newLat, lng: newLng });\n                       }\n                     }).catch(() => {});\n                 } else {\n                    uni.showToast({ title: 'Â∑≤Âà∞ËææÊâìÂç°ÁÇπËåÉÂõ¥ÔºÅ', icon: 'success' });\n                 }\n                 uni.setStorageSync('checkpointReached', '1');\n              }\n            } else {\n              isReach.value = false;\n            }\n          }\n          if (currentMode.value === 'normal') {\n             normalProgress.value = Math.min(100, ((distance.value/1000) / dailyTarget.value) * 100);\n          } else if (currentMode.value === 'police') {\n             policeProgress.value = Math.min(100, (distance.value / policeTargetDistance.value) * 100);\n          }\n        }\n      });\n    },\n    fail: () => {\n      uni.showToast({ title: 'Êó†Ê≥ïËé∑ÂèñÂÆûÊó∂‰ΩçÁΩÆÔºåËØ∑Ê£ÄÊü•ÊùÉÈôê', icon: 'none' });\n    }\n  });\n  // #endif\n};\n\nconst stopRealLocationTracking = () => {\n  // #ifdef H5\n  if (h5LocationTimer) {\n    clearInterval(h5LocationTimer);\n    h5LocationTimer = null;\n  }\n  // #endif\n  // #ifndef H5\n  uni.stopLocationUpdate();\n  uni.offLocationChange();\n  // #endif\n};\n\n// 2. Ë∑ëÊ≠•Ê†∏ÂøÉÈÖçÁΩÆ\nconst currentMode = ref('normal'); // normal-ÊôÆÈÄö police-Ë≠¶Âä° campus-Ê†°Âõ≠\nconst isRunning = ref(false);\nconst duration = ref(0);\nconst distance = ref(0); // Â∑≤Ë∑ëË∑ùÁ¶ªÔºàÁ±≥Ôºâ\nconst distanceToCheckpoint = ref(0);\nconst isReach = ref(false);\nconst stepCount = ref(0);\nconst heartRate = ref(80);\nconst currentSpeed = ref(0); // ÂÆûÊó∂ÈÄüÂ∫¶ m/s\nconst maxSpeed = ref(0); // ÊúÄÂ§ßÈÄüÂ∫¶ m/s\nlet timer = null;\nlet accelerometerCallback = null;\nlet h5LocationTimer = null;\n\n// 3. Ë≠¶Âä°‰∏ìÈ°πÂõ∫ÂÆöÈÖçÁΩÆÔºàÊåâÂÖ¨ÂÆâËÄÉÊ†∏Ê†áÂáÜÔºâ\nconst policeTargetDistance = ref(2000); // Âõ∫ÂÆö2000Á±≥\nconst policeTargetPace = ref(6.5); // ËææÊ†áÈÖçÈÄüÔºö6.5ÂàÜÈíü/ÂÖ¨ÈáåÔºàÁî∑ÁîüÊ†áÂáÜÔºâ\n// ËÆ°ÁÆóÂΩìÂâçÈÖçÈÄüÔºàÂàÜÈíü/ÂÖ¨ÈáåÔºâ\nconst currentPace = computed(() => {\n  const km = distance.value / 1000;\n  const min = duration.value / 60;\n  return km === 0 ? 0 : min / km;\n});\n// ÂÆûÊó∂ÈÄüÂ∫¶Â±ïÁ§∫ (km/h)\nconst currentSpeedKmh = computed(() => (currentSpeed.value * 3.6).toFixed(1));\n// Âπ≥ÂùáÈÄüÂ∫¶ (km/h)\nconst avgSpeedKmh = computed(() => {\n  if (duration.value === 0) return 0;\n  return ((distance.value / 1000) / (duration.value / 3600)).toFixed(1);\n});\n\n// Êé•Êî∂È°µÈù¢ÂèÇÊï∞\nonLoad((options) => {\n  if (options.mode) {\n    currentMode.value = options.mode;\n  }\n  if (options.target) {\n    policeTargetDistance.value = parseInt(options.target);\n  }\n  if (options.course) {\n    uni.showToast({ title: `ÂºÄÂßãËØæÁ®ãÔºö${options.course}`, icon: 'none' });\n  }\n});\n\n// È°µÈù¢ÊòæÁ§∫Êó∂ÂàùÂßãÂåñ\nonShow(() => {\n    const role = uni.getStorageSync('userRole') || uni.getStorageSync('role');\n    if (role === 'teacher') {\n      uni.showToast({ title: 'ËØ•ÂäüËÉΩ‰ªÖÂØπÂ≠¶ÁîüÂºÄÊîæ', icon: 'none' });\n      setTimeout(() => {\n        uni.redirectTo({ url: '/pages/teacher/home/home' });\n      }, 800);\n      return;\n    }\n  // 1. Â§ÑÁêÜ‰ªéÈ¶ñÈ°µË∑≥ËΩ¨ËøáÊù•ÁöÑÊ®°ÂºèÂèÇÊï∞ (Âõ† switchTab ‰∏çÊîØÊåÅ URL ‰º†ÂèÇ)\n  const targetMode = uni.getStorageSync('runMode');\n  if (targetMode) {\n    switchMode(targetMode); // ‰ΩøÁî® switchMode ÊñπÊ≥ï‰ª•Á°Æ‰øùÁä∂ÊÄÅÈáçÁΩÆ\n    uni.removeStorageSync('runMode'); // Ê∂àË¥πÂêéÊ∏ÖÈô§\n  }\n\n  getLocation();\n  checkpoint.value = uni.getStorageSync('checkpoint') || {};\n  if (checkpoint.value.name) {\n    addCheckpointMarker(checkpoint.value.lat, checkpoint.value.lng, checkpoint.value.name);\n  }\n  const records = uni.getStorageSync('runRecordsList') || [];\n  const now = new Date();\n  const dayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();\n  const dayEnd = dayStart + 24 * 60 * 60 * 1000;\n  let c = 0;\n  let d = 0;\n  records.forEach(r => {\n    const t = new Date(r.createTime).getTime();\n    const isRunType = r.type ? r.type === 'run' : true;\n    if (isRunType && t >= dayStart && t < dayEnd) {\n      c += 1;\n      d += Number(r.distance) || 0;\n    }\n  });\n  todayRunCount.value = c;\n  todayRunDistance.value = Number(d.toFixed(2));\n  historyList.value = buildHistory(records);\n  const taskStr = uni.getStorageSync('teacherTask');\n  if (taskStr) {\n    try {\n      const obj = typeof taskStr === 'string' ? JSON.parse(taskStr) : taskStr;\n      teacherRunTask.value = obj.title || '';\n    } catch (e) {\n      teacherRunTask.value = '';\n    }\n  }\n});\n\n// 4. ÂÆö‰Ωç‰ºòÂåñÔºàÂê´ÊùÉÈôêÁî≥ËØ∑+Ê†°Âõ≠Âõ¥Ê†èÔºâ\nconst getLocation = () => {\n  // #ifdef H5\n  doGetLocation();\n  // #endif\n\n  // #ifndef H5\n  uni.authorize({\n    scope: 'scope.userLocation',\n    success: () => {\n      doGetLocation();\n    },\n    fail: () => {\n      uni.showModal({\n        title: 'ÊùÉÈôêÁî≥ËØ∑',\n        content: 'ÈúÄË¶ÅÂÆö‰ΩçÊùÉÈôêÊâçËÉΩ‰ΩøÁî®ÊâìÂç°/Ë∑ëÊ≠•ÂäüËÉΩÔºåËØ∑ÂâçÂæÄËÆæÁΩÆÂºÄÂêØ',\n        confirmText: 'ÂéªËÆæÁΩÆ',\n        success: (res) => {\n          if (res.confirm) uni.openSetting();\n        }\n      });\n    }\n  });\n  // #endif\n};\n\nconst doGetLocation = () => {\n  // Load cached location for faster map rendering\n  const lastLoc = uni.getStorageSync('lastLocation');\n  if (lastLoc) {\n    lat.value = lastLoc.lat;\n    lng.value = lastLoc.lng;\n    markers.value = [{\n      id: 0,\n      latitude: lastLoc.lat,\n      longitude: lastLoc.lng,\n      title: 'ÊàëÁöÑ‰ΩçÁΩÆ',\n      iconPath: '/static/location.png',\n      width: 30,\n      height: 30\n    }];\n  }\n\n  uni.getLocation({\n    type: 'gcj02',\n    accuracy: 'high',\n    success: (res) => {\n      lat.value = res.latitude;\n      lng.value = res.longitude;\n      markers.value = [{\n        id: 0,\n        latitude: res.latitude,\n        longitude: res.longitude,\n        title: 'ÊàëÁöÑ‰ΩçÁΩÆ',\n        iconPath: '/static/location.png',\n        width: 30,\n        height: 30\n      }];\n      // Ê†°Âõ≠Âõ¥Ê†èÔºà‰ªÖÊ†°Âõ≠ÊâìÂç°Áî®Ôºâ\n      const campusLatMin = 39.90;\n      const campusLatMax = 39.92;\n      const campusLngMin = 116.39;\n      const campusLngMax = 116.41;\n      const isInCampus = res.latitude >= campusLatMin && res.latitude <= campusLatMax \n                      && res.longitude >= campusLngMin && res.longitude <= campusLngMax;\n      if (!isInCampus && currentMode.value === 'campus') {\n        uni.showToast({ title: '‰ªÖÊ†°Âõ≠ÂÜÖÂèØËøõË°åÊâìÂç°', icon: 'none' });\n      }\n    },\n    fail: (err) => {\n      console.error('Location failed:', err);\n      let msg = 'ÂÆö‰ΩçÂ§±Ë¥•ÔºåÂ∑≤‰ΩøÁî®Ê®°Êãü‰ΩçÁΩÆ';\n      \n      // #ifdef H5\n      // ChromeÁ≠âÊµèËßàÂô®ÈôêÂà∂ÈùûHTTPSÁéØÂ¢ÉÊó†Ê≥ï‰ΩøÁî®ÂÆö‰ΩçÔºàlocalhostÈô§Â§ñÔºâ\n      if (location.protocol !== 'https:' && location.hostname !== 'localhost' && location.hostname !== '127.0.0.1') {\n        msg = 'H5ÂÆö‰ΩçÈúÄHTTPSÔºåÂ∑≤ÂàáÊ®°Êãü‰ΩçÁΩÆ';\n      } else if (err.errMsg && err.errMsg.indexOf('auth') !== -1) {\n        msg = 'ÂÆö‰ΩçÊùÉÈôêË¢´ÊãíÔºåÂ∑≤ÂàáÊ®°Êãü‰ΩçÁΩÆ';\n      }\n      // #endif\n\n      uni.showToast({ title: msg, icon: 'none', duration: 3000 });\n      \n      // ÈôçÁ∫ß‰ΩøÁî®Ê®°Êãü‰ΩçÁΩÆÔºàÂåó‰∫¨Â§©ÂÆâÈó®ÈôÑËøëÔºâ\n      lat.value = 39.908823;\n      lng.value = 116.397470;\n      markers.value = [{ \n        id: 0, \n        latitude: 39.908823, \n        longitude: 116.397470, \n        title: 'ÊàëÁöÑ‰ΩçÁΩÆ (Ê®°Êãü)', \n        iconPath: '/static/location.png', \n        width: 30, \n        height: 30 \n      }];\n    }\n  });\n};\n\n// 5. ÊêúÁ¥¢ÊâìÂç°ÁÇπÔºà‰ªÖÊ†°Âõ≠Ê®°ÂºèÔºâ\nconst searchCheckpoint = () => {\n  if (!checkpointName.value) {\n    uni.showToast({ title: 'ËØ∑ËæìÂÖ•ÊâìÂç°ÁÇπÂêçÁß∞', icon: 'none' });\n    return;\n  }\n  const newCheckpoint = {\n    name: checkpointName.value,\n    lat: lat.value + 0.001,\n    lng: lng.value + 0.001\n  };\n  uni.setStorageSync('checkpoint', newCheckpoint);\n  checkpoint.value = newCheckpoint;\n  addCheckpointMarker(newCheckpoint.lat, newCheckpoint.lng, newCheckpoint.name);\n  polyline.value = [{\n    points: [\n      { latitude: lat.value, longitude: lng.value },\n      { latitude: newCheckpoint.lat, longitude: newCheckpoint.lng }\n    ],\n    color: '#FF0000',\n    width: 5\n  }];\n  uni.showToast({ title: `ÊâæÂà∞${newCheckpoint.name}`, icon: 'success' });\n};\n\n// 6. Ê∑ªÂä†ÊâìÂç°ÁÇπÊ†áËÆ∞\nconst addCheckpointMarker = (lat, lng, name) => {\n  markers.value.push({\n    id: 1,\n    latitude: lat,\n    longitude: lng,\n    title: name,\n    iconPath: '/static/checkpoint.png',\n    width: 40,\n    height: 40\n  });\n};\n\n// 7. ÂàáÊç¢Ë∑ëÊ≠•Ê®°ÂºèÔºàÊôÆÈÄö/Ë≠¶Âä°/Ê†°Âõ≠Ôºâ\nconst switchMode = (mode) => {\n  // ÂàáÊç¢Ê®°ÂºèÊó∂ÈáçÁΩÆÊâÄÊúâË∑ëÊ≠•Áä∂ÊÄÅ\n  isRunning.value = false;\n  clearInterval(timer);\n  stopStepCount();\n  duration.value = 0;\n  distance.value = 0;\n  stepCount.value = 0;\n  heartRate.value = 80;\n  currentMode.value = mode;\n};\n\n// 8. Ê≠•Êï∞ÁªüËÆ°ÔºàÂä†ÈÄüÂ∫¶‰º†ÊÑüÂô®Ôºâ\nconst startStepCount = () => {\n  accelerometerCallback = (res) => {\n    const acceleration = Math.sqrt(res.x*res.x + res.y*res.y + res.z*res.z);\n    if (acceleration > 15) stepCount.value += 1;\n  };\n  uni.onAccelerometerChange(accelerometerCallback);\n};\nconst stopStepCount = () => {\n  if (accelerometerCallback) {\n    uni.offAccelerometerChange(accelerometerCallback);\n    accelerometerCallback = null;\n  }\n};\n\n// 9. ÂøÉÁéáÊõ¥Êñ∞+È¢ÑË≠¶\nconst updateHeartRate = () => {\n  heartRate.value = 80 + Math.floor(duration.value / 10);\n  if (heartRate.value > 180) {\n    uni.showModal({\n      title: 'ÂÅ•Â∫∑È¢ÑË≠¶',\n      content: `ÂΩìÂâçÂøÉÁéáËøáÈ´òÔºà${heartRate.value}Ê¨°/ÂàÜÔºâÔºåÂª∫ËÆÆÈôçÈÄü‰ºëÊÅØ`,\n      showCancel: false\n    });\n  }\n};\n\n// 10. ÂºÄÂßãË∑ëÊ≠•ÔºàÂàÜ‰∏âÁßçÊ®°ÂºèÔºâ\n// ÊôÆÈÄöË∑ëÊ≠•ÔºàÊó†Âõ∫ÂÆöÁõÆÊ†áÔºâ\nconst startNormalRun = () => {\n  isRunning.value = true;\n  duration.value = 0;\n  distance.value = 0;\n  stepCount.value = 0;\n  heartRate.value = 80;\n  uni.removeStorageSync('checkpointReached');\n  startRealLocationTracking();\n  startStepCount();\n  timer = setInterval(() => {\n    duration.value += 1;\n    updateHeartRate();\n  }, 1000);\n};\n\n// ‰∏ìÈ°πËÆ≠ÁªÉÔºàÂõ∫ÂÆö2000Á±≥ÔºåÊåâËææÊ†áÈÖçÈÄüË∑ëÔºâ\nconst startPoliceRun = () => {\n  isRunning.value = true;\n  duration.value = 0;\n  distance.value = 0;\n  stepCount.value = 0;\n  heartRate.value = 80;\n  uni.removeStorageSync('policeFinishTip');\n  startRealLocationTracking();\n  startStepCount();\n  timer = setInterval(() => {\n    duration.value += 1;\n    updateHeartRate();\n    // ËææÂà∞ÁõÆÊ†áË∑ùÁ¶ªÂºπÁ™óÊèêÁ§∫\n    if (distance.value >= policeTargetDistance.value && !uni.getStorageSync('policeFinishTip')) {\n      uni.showToast({ title: 'Â∑≤ÂÆåÊàê2000Á±≥ÁõÆÊ†áÔºÅ', icon: 'success' });\n      uni.setStorageSync('policeFinishTip', '1');\n    }\n  }, 1000);\n};\n\n// Ê†°Âõ≠ÊâìÂç°\nconst startCampusRun = () => {\n  isRunning.value = true;\n  duration.value = 0;\n  isReach.value = false;\n  stepCount.value = 0;\n  heartRate.value = 80;\n  uni.removeStorageSync('checkpointReached');\n  startRealLocationTracking();\n  startStepCount();\n  timer = setInterval(() => {\n    duration.value += 1;\n    updateHeartRate();\n  }, 1000);\n};\n\n// 11. ÁªìÊùüË∑ëÊ≠•ÔºàÁªü‰∏ÄÈÄªËæëÔºâ\nconst stopRun = async () => {\n  if (!isRunning.value) return;\n  isRunning.value = false;\n  clearInterval(timer);\n  stopStepCount();\n  stopRealLocationTracking();\n\n  const token = uni.getStorageSync('token');\n  if (!token) {\n    uni.showToast({ title: 'ËØ∑ÂÖàÁôªÂΩï', icon: 'none' });\n    setTimeout(() => {\n      uni.reLaunch({ url: '/pages/login/login' });\n    }, 800);\n    return;\n  }\n\n  const runData = {\n    type: currentMode.value === 'police' ? 'test' : 'run',\n    source: 'free',\n    started_at: new Date(Date.now() - duration.value * 1000).toISOString(),\n    ended_at: new Date().toISOString(),\n    metrics: {\n      distance: distance.value / 1000, // Convert meters to km\n      duration: duration.value,\n      pace: currentPace.value.toFixed(1),\n      count: currentMode.value === 'police' ? 1 : null,\n      qualified: currentMode.value === 'police' ? currentPace.value <= policeTargetPace.value : false,\n      trajectory: JSON.stringify(trajectoryPoints.value),\n      checkpoints: JSON.stringify(checkinRecords.value)\n    },\n    evidence: []\n  };\n\n  try {\n    uni.showLoading({ title: 'Êèê‰∫§‰∏≠...' });\n    const res = await submitActivity(runData);\n    uni.hideLoading();\n    \n    // Jump to result page with data\n    uni.navigateTo({\n      url: `/pages/result/result?data=${encodeURIComponent(JSON.stringify(runData))}`\n    });\n  } catch (error) {\n    uni.hideLoading();\n    console.error('Submit failed:', error);\n    uni.showToast({\n      title: (error && error.detail) ? `Êèê‰∫§Â§±Ë¥•Ôºö${error.detail}` : 'Êèê‰∫§Â§±Ë¥•ÔºåËØ∑ÈáçËØï',\n      icon: 'none',\n      duration: 2000\n    });\n  }\n};\n\nconst buildHistory = (records) => {\n  const days = 7;\n  const now = new Date();\n  const arr = [];\n  for (let i=0;i<days;i++) {\n    const day = new Date(now.getFullYear(), now.getMonth(), now.getDate()-i);\n    const start = new Date(day.getFullYear(), day.getMonth(), day.getDate()).getTime();\n    const end = start + 24*60*60*1000;\n    const runRecs = records.filter(r => {\n      const t = new Date(r.createTime).getTime();\n      const isRunType = r.type ? r.type === 'run' : true;\n      return isRunType && t>=start && t<end;\n    });\n    const count = runRecs.length;\n    const distanceSum = runRecs.reduce((s,x)=>s+Number(x.distance||0),0);\n    arr.push({ date: `${day.getMonth()+1}/${day.getDate()}`, count, distance: Number(distanceSum.toFixed(2)) });\n  }\n  return arr.reverse();\n};\n</script>\n\n<style scoped>\n.run {\n  padding: 20rpx;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  padding-bottom: calc(120rpx + env(safe-area-inset-bottom));\n}\n/* Êñ∞Â¢ûÈ°∂ÈÉ®Ê†∑Âºè */\n.top-widgets {\n  margin-bottom: 20rpx;\n}\n.weather-widget {\n  background: linear-gradient(135deg, #74ebd5 0%, #ACB6E5 100%);\n  border-radius: 12rpx;\n  padding: 20rpx;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 15rpx;\n  color: #fff;\n  box-shadow: 0 4rpx 10rpx rgba(0,0,0,0.1);\n}\n.weather-left { display: flex; flex-direction: column; }\n.weather-temp { font-size: 40rpx; font-weight: bold; }\n.weather-status { font-size: 26rpx; opacity: 0.9; }\n.weather-tips { font-size: 24rpx; background: rgba(255,255,255,0.2); padding: 4rpx 12rpx; border-radius: 20rpx; }\n\n.achievements-scroll {\n  white-space: nowrap;\n  width: 100%;\n}\n.badge-item {\n  display: inline-block;\n  background: #fff;\n  padding: 10rpx 20rpx;\n  border-radius: 30rpx;\n  margin-right: 15rpx;\n  box-shadow: 0 2rpx 5rpx rgba(0,0,0,0.05);\n}\n.badge-icon { margin-right: 8rpx; }\n.badge-name { font-size: 24rpx; color: #333; }\n\n/* Êé®ËçêË∑ØÁ∫øÊ†∑Âºè */\n.routes-card {\n  background: #fff;\n  border-radius: 12rpx;\n  padding: 20rpx;\n  margin-bottom: 20rpx;\n  box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);\n}\n.card-header { display: flex; justify-content: space-between; align-items: center; }\n.card-title { font-size: 30rpx; font-weight: bold; color: #333; }\n.card-toggle { font-size: 24rpx; color: #999; }\n.routes-list { margin-top: 15rpx; border-top: 1px solid #f5f5f5; padding-top: 10rpx; }\n.route-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 15rpx 0;\n  border-bottom: 1px dashed #eee;\n}\n.route-item:last-child { border-bottom: none; }\n.route-info { display: flex; flex-direction: column; }\n.route-name { font-size: 28rpx; color: #333; }\n.route-meta { font-size: 24rpx; color: #999; margin-top: 4rpx; }\n.route-action { font-size: 24rpx; color: #20C997; }\n\n.overview-card {\n  background: #ffffff;\n  border: 1px solid #eee;\n  border-radius: 12rpx;\n  padding: 20rpx;\n  margin-bottom: 20rpx;\n}\n.overview-title {\n  font-size: 30rpx;\n  font-weight: bold;\n  color: #333;\n  display: block;\n  margin-bottom: 10rpx;\n}\n.overview-meta {\n  font-size: 28rpx;\n  color: #666;\n  display: flex;\n  justify-content: space-between;\n}\n.task-tip {\n  margin-top: 10rpx;\n  font-size: 26rpx;\n  color: #d81e06;\n}\n.progress-wrap { padding: 10rpx 20rpx; }\n.progress-bar { width: 100%; height: 16rpx; background: #eee; border-radius: 10rpx; overflow: hidden; }\n.progress-fill { height: 100%; background: #20C997; width: 0; }\n.progress-text { font-size: 26rpx; color: #666; text-align: center; margin-top: 6rpx; display: block; }\n/* ÊêúÁ¥¢Ê†è‰ªÖÊ†°Âõ≠Ê®°ÂºèÊòæÁ§∫ */\n.search-bar {\n  display: flex;\n  margin-bottom: 20rpx;\n}\n.search-input {\n  flex: 1;\n  border: 1px solid #eee;\n  padding: 15rpx;\n  border-radius: 8rpx;\n  margin-right: 10rpx;\n}\n.search-btn {\n  background-color: #20C997;\n  color: #fff;\n  border: none;\n  border-radius: 8rpx;\n  padding: 0 20rpx;\n}\n/* Âú∞Âõæ */\n.map {\n  width: 100%;\n  height: 300rpx;\n  border-radius: 10rpx;\n  margin-bottom: 20rpx;\n}\n/* Ê®°ÂºèÂàáÊç¢Ôºà‰∏âÈÄâ‰∏ÄÔºâ */\n.mode-switch {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 20rpx;\n  flex-wrap: wrap;\n}\n.mode-item {\n  padding: 15rpx 30rpx;\n  margin: 0 8rpx 10rpx;\n  font-size: 30rpx;\n  border-bottom: 2rpx solid transparent;\n}\n.mode-item.active {\n  border-bottom-color: #d81e06;\n  color: #d81e06;\n  font-weight: bold;\n}\n/* Ë≠¶Âä°‰∏ìÈ°πËÆ°ÂàíÊ®°Âùó */\n.police-plan {\n  background-color: #fdf2f0;\n  border: 1px solid #fef0f0;\n  border-radius: 10rpx;\n  padding: 20rpx;\n  margin-bottom: 20rpx;\n}\n.plan-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #d81e06;\n  display: block;\n  text-align: center;\n  margin-bottom: 15rpx;\n}\n.plan-info {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n}\n.info-item {\n  font-size: 26rpx;\n  color: #666;\n  margin: 5rpx 10rpx;\n}\n.highlight {\n  color: #d81e06;\n  font-weight: bold;\n}\n/* ÈÄöÁî®Ë∑ëÊ≠•Ê®°ÂùóÊ†∑Âºè */\n.run-mode-box {\n  margin-bottom: 20rpx;\n}\n.tip {\n  font-size: 28rpx;\n  color: #666;\n  text-align: center;\n  margin-bottom: 20rpx;\n  padding: 0 20rpx;\n}\n.no-checkpoint {\n  text-align: center;\n  padding: 20rpx 0;\n}\n.checkpoint-info {\n  font-size: 30rpx;\n  color: #333;\n  text-align: center;\n  margin-bottom: 20rpx;\n  display: block;\n}\n.start-box {\n  text-align: center;\n}\n.start-btn {\n  width: 600rpx;\n  height: 80rpx;\n  line-height: 80rpx;\n  background-color: #20C997;\n  color: #fff;\n  border: none;\n  border-radius: 10rpx;\n  font-size: 32rpx;\n}\n.running-box {\n  text-align: center;\n  padding: 10rpx 0;\n}\n.data {\n  font-size: 28rpx;\n  color: #333;\n  margin-bottom: 10rpx;\n  display: block;\n}\n.pace-status {\n  font-size: 28rpx;\n  margin-bottom: 15rpx;\n  display: block;\n}\n.finish-tip {\n  font-size: 28rpx;\n  color: #20C997;\n  font-weight: bold;\n  margin-bottom: 15rpx;\n  display: block;\n}\n.reach-status {\n  font-size: 28rpx;\n  margin-bottom: 15rpx;\n  display: block;\n}\n.stop-btn {\n  width: 600rpx;\n  height: 80rpx;\n  line-height: 80rpx;\n  background-color: #d81e06;\n  color: #fff;\n  border: none;\n  border-radius: 10rpx;\n  font-size: 32rpx;\n}\n\n/* AI Float Button */\n.ai-float-btn {\n  position: fixed;\n  right: 30rpx;\n  bottom: 200rpx;\n  background: #fff;\n  width: 100rpx;\n  height: 100rpx;\n  border-radius: 50%;\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.15);\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  z-index: 100;\n  animation: pulse 2s infinite;\n}\n\n.ai-btn-icon {\n  font-size: 40rpx;\n  margin-bottom: 4rpx;\n}\n\n.ai-btn-text {\n  font-size: 18rpx;\n  color: #333;\n  font-weight: bold;\n}\n\n@keyframes pulse {\n  0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(32, 201, 151, 0.4); }\n  70% { transform: scale(1.05); box-shadow: 0 0 0 20rpx rgba(32, 201, 151, 0); }\n  100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(32, 201, 151, 0); }\n}\n</style>\n","import MiniProgramPage from 'D:/PC/Document/HBuilderProjects/campus-system/fronted/pages/run/run.vue'\nwx.createPage(MiniProgramPage)"],"names":["onUnmounted","ref","computed","uni","checkIn","res","onLoad","onShow","lat","lng","submitActivity"],"mappings":"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"}