import{r as a,g as s,a as t,b as e,c as l,w as c,i as u,o as n,d as i,e as d,n as o,f as r,h as f,F as _,j as m,k,t as p,l as g,s as v,m as y,p as C,q as b,S as h,u as x,v as j}from"./index-DJkcSMuy.js";import{o as B}from"./uni-app.es.BbaSIkqw.js";import{C as w}from"./CustomTabBar.wh3o2TYd.js";import{g as D}from"./request.DDN5gHc8.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";const E=F({__name:"home",setup(F){const E=a(20),z=a("student"),I=a({}),S=a([]),$=a(!1);B((()=>{E.value=s().statusBarHeight||20;if(!t("token"))return void e({url:"/pages/login/login"});const a=t("userRole")||t("role");a&&(z.value=a);const l=t("userInfo");if(l)try{I.value="string"==typeof l?JSON.parse(l):l}catch(c){console.error("JSON parse error",c),I.value={}}(async()=>{try{const a=await D({page:1,size:20});if(a.items&&a.items.length>0){const s=["pending","in_progress","uncompleted"];if(S.value=a.items.filter((a=>s.includes(a.status))).map((a=>({id:a.id,title:a.title,status:a.status,desc:a.description||(a.min_distance?`ç›®æ ‡: ${a.min_distance}km`:"è¯·æŸ¥çœ‹è¯¦æƒ…")}))),S.value.length>0){const a=t("viewed_task_ids")||[];S.value.some((s=>!a.includes(s.id)))&&($.value=!0)}}else S.value=[]}catch(c){if(!t("token"))return;console.error("Fetch tasks failed",c)}})()}));const N=a(!0),T=a(!1),q=a([{name:"å¼•ä½“å‘ä¸Š",tag:"ä½“æµ‹é¡¹ç›®",tagClass:"tag-police",status:"æœªå®Œæˆ",type:"pull-up"},{name:"ä»°å§èµ·å",tag:"æ—¥å¸¸æµ‹è¯„",tagClass:"tag-daily",status:"è¿›è¡Œä¸­",type:"sit-up"},{name:"ä¿¯å§æ’‘",tag:"åŸºç¡€è®­ç»ƒ",tagClass:"tag-base",status:"æœªå¼€å§‹",type:"push-up"}]),A=a([{id:1,name:"ç»¼åˆä½“èƒ½æµ‹è¯•",type:"è€ƒæ ¸",typeClass:"tag-red",duration:45,difficulty:"é«˜å¼ºåº¦",isCompleted:!1},{id:2,name:"1000ç±³çˆ†å‘åŠ›è®­ç»ƒ",type:"ä¸“é¡¹",typeClass:"tag-blue",duration:20,difficulty:"ä¸­å¼ºåº¦",isCompleted:!0},{id:3,name:"æ ¸å¿ƒåŠ›é‡å¼ºåŒ–è¯¾ç¨‹",type:"æ—¥å¸¸",typeClass:"tag-green",duration:30,difficulty:"ä½Žå¼ºåº¦",isCompleted:!1}]),J=a({name:"åˆ‘ä¾¦å…ˆé”‹è·‘å›¢",rank:3,members:42,totalDistance:1205.8,activityCount:5}),M=a([{name:"äº”å››é’å¹´èŠ‚çŽ¯æ ¡è·‘",time:"5æœˆ4æ—¥ 07:00",status:"æŠ¥åä¸­",statusClass:"status-active",joined:128},{name:"å‘¨æœ«å¤œè·‘æ‰“å¡èµ›",time:"æœ¬å‘¨å…­ 19:00",status:"è¿›è¡Œä¸­",statusClass:"status-ing",joined:56},{name:"è¿åŠ¨æŠ€èƒ½äº¤æµä¼š",time:"ä¸‹å‘¨ä¸‰ 14:00",status:"é¢„å‘Š",statusClass:"status-future",joined:30}]);a([{user:"å¼ ä¼Ÿ",time:"10åˆ†é’Ÿå‰",action:"å®Œæˆäº†",result:"5å…¬é‡Œæ™¨è·‘",likes:12,avatarColor:"#FF6B6B"},{user:"æŽå¨œ",time:"35åˆ†é’Ÿå‰",action:"æ‰“å¡äº†",result:"æ ¸å¿ƒåŠ›é‡è®­ç»ƒ",likes:8,avatarColor:"#4ECDC4"},{user:"çŽ‹å¼º",time:"1å°æ—¶å‰",action:"åˆ·æ–°äº†",result:"3000ç±³ä¸ªäººè®°å½•",likes:25,avatarColor:"#45B7D1"}]);const O=a([{name:"æ™¨è·‘å…ˆé”‹é˜Ÿ",members:56,distance:2300,heat:9800},{name:"é•¿è·‘èè‹±å›¢",members:48,distance:1800,heat:8500},{name:"æ ¡å›­é©¬æ‹‰æ¾ç¤¾",members:42,distance:1205,heat:7200},{name:"é˜³å…‰è¿åŠ¨é˜Ÿ",members:35,distance:980,heat:6e3}]),H=()=>{const a=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEEAD"];return a[Math.floor(Math.random()*a.length)]},R=a=>{y({url:"/pages/student/tasks/list"})},G=()=>{$.value=!1;const a=t("viewed_task_ids")||[],s=S.value.map((a=>a.id)),e=[...new Set([...a,...s])];v("viewed_task_ids",e)},K=()=>{y({url:"/pages/ai-police/ai-police"})},L=()=>{y({url:"/pages/activity/list"})},P=()=>{C({title:"åˆ›å»ºåŠŸèƒ½å³å°†ä¸Šçº¿",icon:"none"})},Q=()=>{C({title:"åŠ å…¥åŠŸèƒ½å³å°†ä¸Šçº¿",icon:"none"})},U=()=>{C({title:"è·‘å›¢è¯¦æƒ…",icon:"none"})},V=()=>{T.value=!0},W=()=>{T.value=!1};return(a,s)=>{const t=b,e=u,v=h,C=x;return n(),l(e,{class:"home-container"},{default:c((()=>[i(e,{class:"custom-navbar",style:o({paddingTop:E.value+"px"})},{default:c((()=>[i(e,{class:"navbar-content"},{default:c((()=>[i(t,{class:"navbar-title"},{default:c((()=>[d("é¦–é¡µ")])),_:1})])),_:1})])),_:1},8,["style"]),i(e,{class:"content-wrapper",style:o({paddingTop:E.value+44+"px"})},{default:c((()=>[i(e,{class:"student-dashboard"},{default:c((()=>[i(e,{class:"header-section"},{default:c((()=>[S.value.length>0?(n(),l(e,{key:0,class:"tasks-list"},{default:c((()=>[(n(!0),r(_,null,f(S.value,((a,s)=>(n(),l(e,{class:"teacher-task-box",key:a.id,onClick:a=>R()},{default:c((()=>[i(e,{class:"task-icon-box"},{default:c((()=>[i(t,{class:"task-icon"},{default:c((()=>[d("ðŸ“¢")])),_:1})])),_:1}),i(e,{class:"task-content"},{default:c((()=>[i(t,{class:"task-title"},{default:c((()=>[d("æ–°ä»»åŠ¡: "+p(a.title),1)])),_:2},1024),i(t,{class:"task-desc"},{default:c((()=>[d(p(a.desc),1)])),_:2},1024)])),_:2},1024),i(e,{class:"task-action"},{default:c((()=>[i(t,{class:"btn-text"},{default:c((()=>[d("åŽ»å®Œæˆ")])),_:1})])),_:1})])),_:2},1032,["onClick"])))),128))])),_:1})):m("",!0),i(e,{class:"student-func-grid"},{default:c((()=>[i(e,{class:"stu-func-item",onClick:K},{default:c((()=>[i(e,{class:"stu-func-icon"},{default:c((()=>[d("ðŸ¤–")])),_:1}),i(t,{class:"stu-func-name"},{default:c((()=>[d("AIè®¡æ•°")])),_:1})])),_:1}),i(e,{class:"stu-func-item",onClick:L},{default:c((()=>[i(e,{class:"stu-func-icon"},{default:c((()=>[d("ðŸš©")])),_:1}),i(t,{class:"stu-func-name"},{default:c((()=>[d("è·‘å›¢æ´»åŠ¨")])),_:1})])),_:1}),i(e,{class:"stu-func-item",onClick:s[0]||(s[0]=a=>k({url:"/pages/test/test"}))},{default:c((()=>[i(e,{class:"stu-func-icon"},{default:c((()=>[d("ðŸ“Š")])),_:1}),i(t,{class:"stu-func-name"},{default:c((()=>[d("ä½“æµ‹æˆç»©")])),_:1})])),_:1}),i(e,{class:"stu-func-item",onClick:s[1]||(s[1]=a=>k({url:"/pages/mine/mine"}))},{default:c((()=>[i(e,{class:"stu-func-icon"},{default:c((()=>[d("ðŸ‘¤")])),_:1}),i(t,{class:"stu-func-name"},{default:c((()=>[d("ä¸ªäººä¸­å¿ƒ")])),_:1})])),_:1})])),_:1})])),_:1}),i(e,{class:"section-container module-card"},{default:c((()=>[i(e,{class:"section-header"},{default:c((()=>[i(t,{class:"section-title"},{default:c((()=>[d("ä½“èƒ½è€ƒæ ¸é¡¹ç›®")])),_:1})])),_:1}),i(e,{class:"test-project-list"},{default:c((()=>[(n(!0),r(_,null,f(q.value,((a,s)=>(n(),l(e,{class:"test-card",key:s,onClick:s=>(a=>{k({url:"/pages/test/test?project="+a.name+"&type="+a.type})})(a)},{default:c((()=>[i(e,{class:"test-icon"},{default:c((()=>[d(p("pull-up"===a.type?"ðŸ’ª":"sit-up"===a.type?"ðŸ§˜":"ðŸ‹ï¸"),1)])),_:2},1024),i(e,{class:"test-info"},{default:c((()=>[i(t,{class:"test-name"},{default:c((()=>[d(p(a.name),1)])),_:2},1024),i(e,{class:"test-tags"},{default:c((()=>[i(t,{class:j(["tag-small",a.tagClass])},{default:c((()=>[d(p(a.tag),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),i(t,{class:"test-status"},{default:c((()=>[d(p(a.status),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),i(e,{class:"section-container module-card"},{default:c((()=>[i(e,{class:"section-header",onClick:s[2]||(s[2]=a=>N.value=!N.value)},{default:c((()=>[i(t,{class:"section-title"},{default:c((()=>[d("ä¸“é¡¹è®­ç»ƒè®¡åˆ’")])),_:1}),i(t,{class:"section-more"},{default:c((()=>[d(p(N.value?"æ”¶èµ·":"å±•å¼€"),1)])),_:1})])),_:1}),N.value?(n(),l(e,{key:0,class:"training-list"},{default:c((()=>[(n(!0),r(_,null,f(A.value,((a,s)=>(n(),l(e,{class:"training-card",key:s,onClick:s=>(a=>{y({url:`/pages/run/run?mode=training&planId=${a.id}&name=${a.name}`})})(a)},{default:c((()=>[i(e,{class:"card-left"},{default:c((()=>[i(e,{class:j(["tag-box",a.typeClass])},{default:c((()=>[i(t,{class:"tag-text"},{default:c((()=>[d(p(a.type),1)])),_:2},1024)])),_:2},1032,["class"]),i(e,{class:"training-info"},{default:c((()=>[i(t,{class:"training-name"},{default:c((()=>[d(p(a.name),1)])),_:2},1024),i(t,{class:"training-meta"},{default:c((()=>[d(p(a.duration)+"åˆ†é’Ÿ Â· "+p(a.difficulty),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(e,{class:"card-right"},{default:c((()=>[a.isCompleted?(n(),l(e,{key:0,class:"status-icon"},{default:c((()=>[i(t,null,{default:c((()=>[d("âœ…")])),_:1})])),_:1})):(n(),l(e,{key:1,class:"start-btn-small"},{default:c((()=>[i(t,null,{default:c((()=>[d("å¼€å§‹")])),_:1})])),_:1}))])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):m("",!0)])),_:1}),i(e,{class:"section-container module-card"},{default:c((()=>[i(e,{class:"section-header"},{default:c((()=>[i(t,{class:"section-title"},{default:c((()=>[d("è·‘å›¢è”ç›Ÿ")])),_:1}),i(e,{class:"header-actions"},{default:c((()=>[i(t,{class:"action-link",onClick:P},{default:c((()=>[d("åˆ›å»º")])),_:1}),i(t,{class:"divider"},{default:c((()=>[d("|")])),_:1}),i(t,{class:"action-link",onClick:Q},{default:c((()=>[d("åŠ å…¥")])),_:1}),i(t,{class:"divider"},{default:c((()=>[d("|")])),_:1}),i(t,{class:"action-link",onClick:L},{default:c((()=>[d("æ´»åŠ¨æµè§ˆ")])),_:1})])),_:1})])),_:1}),i(e,{class:"my-club-card",onClick:U},{default:c((()=>[i(e,{class:"club-bg-overlay"}),i(e,{class:"club-info"},{default:c((()=>[i(e,{class:"club-header"},{default:c((()=>[i(t,{class:"club-name"},{default:c((()=>[d(p(J.value.name),1)])),_:1}),i(t,{class:"club-rank"},{default:c((()=>[d("No."+p(J.value.rank),1)])),_:1})])),_:1}),i(e,{class:"club-stats"},{default:c((()=>[i(e,{class:"stat-box"},{default:c((()=>[i(t,{class:"val"},{default:c((()=>[d(p(J.value.members),1)])),_:1}),i(t,{class:"label"},{default:c((()=>[d("æˆå‘˜")])),_:1})])),_:1}),i(e,{class:"stat-box"},{default:c((()=>[i(t,{class:"val"},{default:c((()=>[d(p(J.value.totalDistance),1)])),_:1}),i(t,{class:"label"},{default:c((()=>[d("æ€»é‡Œç¨‹(km)")])),_:1})])),_:1}),i(e,{class:"stat-box"},{default:c((()=>[i(t,{class:"val"},{default:c((()=>[d(p(J.value.activityCount),1)])),_:1}),i(t,{class:"label"},{default:c((()=>[d("æœ¬æœˆæ´»åŠ¨")])),_:1})])),_:1})])),_:1})])),_:1}),i(e,{class:"rank-entry",onClick:g(V,["stop"])},{default:c((()=>[i(t,{class:"rank-icon"},{default:c((()=>[d("ðŸ†")])),_:1}),i(t,{class:"rank-text"},{default:c((()=>[d("æŽ’è¡Œæ¦œ")])),_:1})])),_:1})])),_:1}),i(e,{class:"community-feed"},{default:c((()=>[i(t,{class:"feed-title"},{default:c((()=>[d("æœ€æ–°åŠ¨æ€")])),_:1}),i(v,{"scroll-x":"",class:"activity-scroll"},{default:c((()=>[(n(!0),r(_,null,f(M.value,((a,s)=>(n(),l(e,{class:"activity-card",key:s,onClick:s=>(a=>{y({url:`/pages/activity/detail?name=${a.name}`})})(a)},{default:c((()=>[i(e,{class:j(["act-tag",a.statusClass])},{default:c((()=>[d(p(a.status),1)])),_:2},1032,["class"]),i(t,{class:"act-name"},{default:c((()=>[d(p(a.name),1)])),_:2},1024),i(t,{class:"act-time"},{default:c((()=>[d("ðŸ•’ "+p(a.time),1)])),_:2},1024),i(e,{class:"act-users"},{default:c((()=>[i(e,{class:"avatar-group"},{default:c((()=>[(n(),r(_,null,f(3,(a=>i(e,{class:"avatar-circle",key:a,style:o({backgroundColor:H()})},null,8,["style"]))),64))])),_:1}),i(t,{class:"act-count"},{default:c((()=>[d(p(a.joined)+"äººå·²æŠ¥å",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),i(e,{style:{height:"120rpx"}}),i(w,{current:"/pages/home/home"}),$.value?(n(),l(e,{key:0,class:"modal-overlay",onClick:G},{default:c((()=>[i(e,{class:"rank-modal",onClick:s[3]||(s[3]=g((()=>{}),["stop"]))},{default:c((()=>[i(e,{class:"modal-header"},{default:c((()=>[i(t,{class:"modal-title"},{default:c((()=>[d("ðŸ”” æ‚¨æœ‰æ–°çš„ä»»åŠ¡")])),_:1}),i(t,{class:"close-btn",onClick:G},{default:c((()=>[d("Ã—")])),_:1})])),_:1}),i(e,{class:"rank-list"},{default:c((()=>[(n(!0),r(_,null,f(S.value,((a,s)=>(n(),l(e,{class:"teacher-task-box",key:a.id,onClick:a=>R(),style:{"margin-bottom":"20rpx",background:"#f9f9f9",width:"100%","box-sizing":"border-box"}},{default:c((()=>[i(e,{class:"task-icon-box"},{default:c((()=>[i(t,{class:"task-icon"},{default:c((()=>[d("ðŸ“")])),_:1})])),_:1}),i(e,{class:"task-content"},{default:c((()=>[i(t,{class:"task-title"},{default:c((()=>[d(p(a.title),1)])),_:2},1024),i(t,{class:"task-desc",style:{"font-size":"20rpx",color:"#666"}},{default:c((()=>[d(p(a.desc),1)])),_:2},1024)])),_:2},1024),i(e,{class:"task-action"},{default:c((()=>[i(t,{class:"btn-text"},{default:c((()=>[d("åŽ»å®Œæˆ")])),_:1})])),_:1})])),_:2},1032,["onClick"])))),128))])),_:1}),i(e,{style:{"margin-top":"20rpx","text-align":"center"}},{default:c((()=>[i(C,{size:"mini",type:"primary",onClick:G,style:{"background-color":"#20C997"}},{default:c((()=>[d("æˆ‘çŸ¥é“äº†")])),_:1})])),_:1})])),_:1})])),_:1})):m("",!0),T.value?(n(),l(e,{key:1,class:"modal-overlay",onClick:W},{default:c((()=>[i(e,{class:"rank-modal",onClick:s[4]||(s[4]=g((()=>{}),["stop"]))},{default:c((()=>[i(e,{class:"modal-header"},{default:c((()=>[i(t,{class:"modal-title"},{default:c((()=>[d("ðŸ† è·‘å›¢æŽ’è¡Œæ¦œ")])),_:1}),i(t,{class:"close-btn",onClick:W},{default:c((()=>[d("Ã—")])),_:1})])),_:1}),i(e,{class:"rank-list"},{default:c((()=>[(n(!0),r(_,null,f(O.value,((a,s)=>(n(),l(e,{class:"rank-item",key:s},{default:c((()=>[i(e,{class:j(["rank-num","rank-"+(s+1)])},{default:c((()=>[d(p(s+1),1)])),_:2},1032,["class"]),i(e,{class:"rank-info"},{default:c((()=>[i(t,{class:"rank-name"},{default:c((()=>[d(p(a.name),1)])),_:2},1024),i(t,{class:"rank-detail"},{default:c((()=>[d(p(a.members)+"äºº / "+p(a.distance)+"km",1)])),_:2},1024)])),_:2},1024),i(e,{class:"rank-trend"},{default:c((()=>[i(t,null,{default:c((()=>[d("ðŸ”¥ "+p(a.heat),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})):m("",!0)])),_:1},8,["style"])])),_:1})}}},[["__scopeId","data-v-8aee0d2e"]]);export{E as default};
