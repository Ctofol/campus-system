import{r as e,x as a,g as l,s,e as t,c as u,w as c,i as n,o as d,a as i,b as o,t as r,d as f,f as _,h as m,F as v,l as p,j as k,C as h,U as g,V as x,aa as b,k as C,I as y,ad as w,ae as N,q as z,S as D,m as S,n as $}from"./index-uRXP6RJd.js";import{o as j}from"./uni-app.es.CewT9dt1.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const V=I({__name:"students",setup(I){const V=e(!1),A=e([]),T=e([]),B=e(!1),E=e([{id:"S1001",name:"å¼ ä¸‰",no:"20240001",className:"ä¾¦æŸ¥ä¸€ç­",group:"ä½“èƒ½Aç»„",status:"æ­£å¸¸",statusClass:"ok",health:"è‰¯å¥½",expanded:!1,recent3km:"12'45\"",weeklyDistance:15.5,attendance:"100%"},{id:"S1002",name:"æå››",no:"20240002",className:"ä¾¦æŸ¥äºŒç­",group:"ä½“èƒ½Bç»„",status:"å¼‚å¸¸",statusClass:"warn",health:"éœ€å…³æ³¨",expanded:!1,recent3km:"15'30\"",weeklyDistance:5,attendance:"80%"},{id:"S1003",name:"ç‹äº”",no:"20240003",className:"æ²»å®‰ä¸€ç­",group:"ä½“èƒ½Aç»„",status:"æ­£å¸¸",statusClass:"ok",health:"è‰¯å¥½",expanded:!1,recent3km:"13'10\"",weeklyDistance:12,attendance:"95%"}]),L=e(""),R=e(["ä¾¦æŸ¥ä¸€ç­","ä¾¦æŸ¥äºŒç­","æ²»å®‰ä¸€ç­"]),U=e(""),q=e(["ä½“èƒ½Aç»„","ä½“èƒ½Bç»„","åº·å¤ç»„"]),F=e(""),O=a((()=>E.value.filter((e=>{const a=L.value.trim(),l=!a||(e.name.includes(a)||e.no.includes(a)),s=!U.value||e.className===U.value,t=!F.value||e.group===F.value;return l&&s&&t})))),G=a((()=>E.value.length)),H=a((()=>E.value.filter((e=>"å¼‚å¸¸"===e.status)).length)),J=a((()=>E.value.filter((e=>"æ­£å¸¸"===e.status)).length)),K=e=>{const a=e.detail.value;U.value=R.value[a]},M=e=>{const a=e.detail.value;F.value=q.value[a]},P=a((()=>O.value.length>0&&A.value.length===O.value.length)),Q=()=>{V.value=!V.value,A.value=[],V.value&&E.value.forEach((e=>e.expanded=!1))},W=e=>{const a=A.value.indexOf(e.id);a>-1?A.value.splice(a,1):A.value.push(e.id)},X=()=>{P.value?A.value=[]:A.value=O.value.map((e=>e.id))},Y=()=>{if(0===A.value.length)return s({title:"è¯·å…ˆé€‰æ‹©å­¦å‘˜",icon:"none"});h({title:"æ‰¹é‡æé†’",content:`ç¡®å®šå‘é€‰ä¸­çš„ ${A.value.length} ä½å­¦å‘˜å‘é€è·‘æ­¥æé†’å—ï¼Ÿ`,success:e=>{e.confirm&&(s({title:"å‘é€æˆåŠŸ",icon:"success"}),Q())}})},Z=()=>{if(0===A.value.length)return s({title:"è¯·å…ˆé€‰æ‹©å­¦å‘˜",icon:"none"});g({title:"ç”ŸæˆæŠ¥è¡¨ä¸­..."}),setTimeout((()=>{x(),s({title:"å¯¼å‡ºæˆåŠŸï¼Œå·²å‘é€è‡³é‚®ç®±",icon:"success"}),Q()}),1500)},ee=()=>{if(0===A.value.length)return s({title:"è¯·å…ˆé€‰æ‹©å­¦å‘˜",icon:"none"});b({itemList:q.value,success:e=>{const a=q.value[e.tapIndex];E.value.forEach((e=>{A.value.includes(e.id)&&(e.group=a)})),s({title:"æ‰¹é‡åˆ†ç»„æˆåŠŸ",icon:"success"}),Q()}})};j((()=>{"teacher"!==(l("userRole")||l("role"))&&(s({title:"è¯·ä½¿ç”¨æ•™å¸ˆè´¦å·ç™»å½•",icon:"none"}),t({url:"/pages/login/login"})),T.value=l("mockSharedReports")||[]}));return(e,a)=>{const l=C,t=n,g=y,x=w,j=N,I=z,E=D;return d(),u(t,{class:"students-page"},{default:c((()=>[i(t,{class:"header"},{default:c((()=>[i(t,{class:"title-row"},{default:c((()=>[i(l,{class:"title"},{default:c((()=>[o("å­¦å‘˜ç®¡ç†")])),_:1}),i(t,{class:"batch-toggle",onClick:Q},{default:c((()=>[i(l,null,{default:c((()=>[o(r(V.value?"å–æ¶ˆæ‰¹é‡":"æ‰¹é‡ç®¡ç†"),1)])),_:1})])),_:1})])),_:1}),i(t,{class:"toolbar"},{default:c((()=>[i(g,{modelValue:L.value,"onUpdate:modelValue":a[0]||(a[0]=e=>L.value=e),class:"search",placeholder:"è¾“å…¥å§“åæˆ–å­¦å·"},null,8,["modelValue"]),i(x,{mode:"selector",range:R.value,onChange:K},{default:c((()=>[i(t,{class:"picker"},{default:c((()=>[o(r(U.value||"å…¨éƒ¨ç­çº§")+" â–¾",1)])),_:1})])),_:1},8,["range"]),i(x,{mode:"selector",range:q.value,onChange:M},{default:c((()=>[i(t,{class:"picker"},{default:c((()=>[o(r(F.value||"å…¨éƒ¨å°ç»„")+" â–¾",1)])),_:1})])),_:1},8,["range"])])),_:1}),i(t,{class:"summary"},{default:c((()=>[i(t,{class:"sum-item"},{default:c((()=>[i(l,{class:"sum-val"},{default:c((()=>[o(r(G.value),1)])),_:1}),i(l,{class:"sum-label"},{default:c((()=>[o("æ€»äººæ•°")])),_:1})])),_:1}),i(t,{class:"sum-item"},{default:c((()=>[i(l,{class:"sum-val"},{default:c((()=>[o(r(H.value),1)])),_:1}),i(l,{class:"sum-label"},{default:c((()=>[o("å¼‚å¸¸")])),_:1})])),_:1}),i(t,{class:"sum-item"},{default:c((()=>[i(l,{class:"sum-val"},{default:c((()=>[o(r(J.value),1)])),_:1}),i(l,{class:"sum-label"},{default:c((()=>[o("æ­£å¸¸")])),_:1})])),_:1})])),_:1})])),_:1}),T.value.length>0?(d(),u(t,{key:0,class:"report-notice",onClick:a[1]||(a[1]=e=>B.value=!0)},{default:c((()=>[i(t,{class:"notice-left"},{default:c((()=>[i(l,{class:"notice-icon"},{default:c((()=>[o("ğŸ¤–")])),_:1}),i(l,{class:"notice-text"},{default:c((()=>[o("æ”¶åˆ° "+r(T.value.length)+" ä»½æ–°çš„è¿åŠ¨åˆ†ææŠ¥å‘Š",1)])),_:1})])),_:1}),i(l,{class:"notice-arrow"},{default:c((()=>[o("æŸ¥çœ‹ >")])),_:1})])),_:1})):f("",!0),i(t,{class:p(["card-list",{"has-bottom-bar":V.value}])},{default:c((()=>[(d(!0),_(v,null,m(O.value,((e,a)=>(d(),u(t,{class:"student-card",key:a,onClick:a=>(e=>{V.value?W(e):e.expanded=!e.expanded})(e)},{default:c((()=>[i(t,{class:"card-main"},{default:c((()=>[i(t,{class:"card-left"},{default:c((()=>[V.value?(d(),u(j,{key:0,checked:A.value.includes(e.id),onClick:k((a=>W(e)),["stop"]),color:"#20C997",style:{transform:"scale(0.8)"}},null,8,["checked","onClick"])):f("",!0),i(t,{class:"avatar"},{default:c((()=>[o(r(e.name.slice(0,1)),1)])),_:2},1024),i(t,{class:"info"},{default:c((()=>[i(l,{class:"name"},{default:c((()=>[o(r(e.name)+" ",1),e.group?(d(),u(l,{key:0,class:"group-tag"},{default:c((()=>[o("("+r(e.group)+")",1)])),_:2},1024)):f("",!0)])),_:2},1024),i(l,{class:"meta"},{default:c((()=>[o("å­¦å·ï¼š"+r(e.no),1)])),_:2},1024),i(l,{class:"meta"},{default:c((()=>[o("ç­çº§ï¼š"+r(e.className),1)])),_:2},1024),i(l,{class:"meta"},{default:c((()=>[o("å¥åº·ï¼š"+r(e.health),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(t,{class:"card-right"},{default:c((()=>[i(l,{class:p(["status",e.statusClass])},{default:c((()=>[o(r(e.status),1)])),_:2},1032,["class"]),V.value?f("",!0):(d(),u(l,{key:0,class:"expand-icon"},{default:c((()=>[o(r(e.expanded?"â–²":"â–¼"),1)])),_:2},1024))])),_:2},1024)])),_:2},1024),e.expanded&&!V.value?(d(),u(t,{key:0,class:"card-expanded"},{default:c((()=>[i(t,{class:"exp-grid"},{default:c((()=>[i(t,{class:"exp-item"},{default:c((()=>[i(l,{class:"exp-label"},{default:c((()=>[o("æœ€è¿‘3km")])),_:1}),i(l,{class:"exp-val"},{default:c((()=>[o(r(e.recent3km||"æ— è®°å½•"),1)])),_:2},1024)])),_:2},1024),i(t,{class:"exp-item"},{default:c((()=>[i(l,{class:"exp-label"},{default:c((()=>[o("æœ¬å‘¨è·‘é‡")])),_:1}),i(l,{class:"exp-val"},{default:c((()=>[o(r(e.weeklyDistance||"0")+"km",1)])),_:2},1024)])),_:2},1024),i(t,{class:"exp-item"},{default:c((()=>[i(l,{class:"exp-label"},{default:c((()=>[o("å‡ºå‹¤ç‡")])),_:1}),i(l,{class:"exp-val"},{default:c((()=>[o(r(e.attendance||"100%"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(t,{class:"exp-actions"},{default:c((()=>[i(I,{size:"mini",class:"exp-btn",onClick:k((a=>(e=>{$({url:`/pages/teacher/students/detail?id=${e.id}&name=${e.name}&no=${e.no}&class=${e.className}`})})(e)),["stop"])},{default:c((()=>[o("å®Œæ•´æ¡£æ¡ˆ")])),_:2},1032,["onClick"]),i(I,{size:"mini",class:"exp-btn outline",onClick:k((a=>(e=>{b({itemList:q.value,success:a=>{e.group=q.value[a.tapIndex],s({title:"å·²è°ƒæ•´åˆ†ç»„",icon:"none"})}})})(e)),["stop"])},{default:c((()=>[o("è°ƒæ•´åˆ†ç»„")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)):f("",!0)])),_:2},1032,["onClick"])))),128)),0===O.value.length?(d(),u(t,{key:0,class:"empty"},{default:c((()=>[i(l,null,{default:c((()=>[o("æš‚æ— ç¬¦åˆæ¡ä»¶çš„å­¦å‘˜")])),_:1})])),_:1})):f("",!0)])),_:1},8,["class"]),V.value?(d(),u(t,{key:1,class:"batch-bar"},{default:c((()=>[i(t,{class:"batch-info"},{default:c((()=>[i(j,{checked:P.value,onClick:X,color:"#20C997",style:{transform:"scale(0.8)"}},null,8,["checked"]),i(l,null,{default:c((()=>[o("å·²é€‰ "+r(A.value.length)+" äºº",1)])),_:1})])),_:1}),i(t,{class:"batch-actions"},{default:c((()=>[i(I,{size:"mini",class:"action-btn outline",onClick:ee},{default:c((()=>[o("æ‰¹é‡åˆ†ç»„")])),_:1}),i(I,{size:"mini",class:"action-btn warn",onClick:Y},{default:c((()=>[o("ä¸€é”®æé†’")])),_:1}),i(I,{size:"mini",class:"action-btn",onClick:Z},{default:c((()=>[o("å¯¼å‡ºæ•°æ®")])),_:1})])),_:1})])),_:1})):f("",!0),B.value?(d(),u(t,{key:2,class:"modal-overlay",onClick:a[4]||(a[4]=e=>B.value=!1)},{default:c((()=>[i(t,{class:"report-modal",onClick:a[3]||(a[3]=k((()=>{}),["stop"]))},{default:c((()=>[i(t,{class:"modal-header"},{default:c((()=>[i(l,{class:"modal-title"},{default:c((()=>[o("ğŸ“„ å­¦å‘˜è¿åŠ¨åˆ†ææŠ¥å‘Š")])),_:1}),i(l,{class:"close-btn",onClick:a[2]||(a[2]=e=>B.value=!1)},{default:c((()=>[o("Ã—")])),_:1})])),_:1}),i(E,{"scroll-y":"",class:"report-list"},{default:c((()=>[(d(!0),_(v,null,m(T.value,((e,a)=>(d(),u(t,{class:"report-item",key:a},{default:c((()=>[i(t,{class:"report-meta"},{default:c((()=>[i(l,{class:"report-stu"},{default:c((()=>[o(r(e.studentName),1)])),_:2},1024),i(l,{class:"report-time"},{default:c((()=>[o(r(e.time),1)])),_:2},1024)])),_:2},1024),i(t,{class:"report-card"},{default:c((()=>[i(l,{class:"report-title"},{default:c((()=>[o(r(e.card.title),1)])),_:2},1024),e.card.suggestion?(d(),u(l,{key:0,class:"report-suggestion"},{default:c((()=>[o("ğŸ’¡ "+r(e.card.suggestion),1)])),_:2},1024)):f("",!0),e.card.chartData?(d(),u(t,{key:1,class:"report-chart"},{default:c((()=>[(d(!0),_(v,null,m(e.card.chartData,((e,a)=>(d(),u(t,{class:"mini-bar",key:a},{default:c((()=>[i(l,{class:"mini-label"},{default:c((()=>[o(r(e.label),1)])),_:2},1024),i(t,{class:"mini-track"},{default:c((()=>[i(t,{class:"mini-fill",style:S({width:e.value+"%",background:e.color})},null,8,["style"])])),_:2},1024),i(l,{class:"mini-val"},{default:c((()=>[o(r(e.valText),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)):f("",!0)])),_:2},1024),i(t,{class:"report-actions"},{default:c((()=>[i(I,{size:"mini",class:"reply-btn",onClick:e=>{h({title:"å›å¤æŒ‡å¯¼",editable:!0,placeholderText:"è¯·è¾“å…¥æŒ‡å¯¼å»ºè®®...",success:e=>{e.confirm&&e.content&&s({title:"å·²å‘é€æŒ‡å¯¼",icon:"success"})}})}},{default:c((()=>[o("å›å¤æŒ‡å¯¼")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})):f("",!0)])),_:1})}}},[["__scopeId","data-v-a57d4adb"]]);export{V as default};
