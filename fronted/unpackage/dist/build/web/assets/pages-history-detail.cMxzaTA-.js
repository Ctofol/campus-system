import{r as e,z as a,c as t,w as l,i as s,o as i,d as u,e as d,t as c,v as r,j as o,q as n,P as v,_ as f}from"./index-DJkcSMuy.js";import{a as p}from"./uni-app.es.BbaSIkqw.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";const y=_({__name:"detail",setup(_){const y=e({}),g=e(39.909),h=e(116.397),m=e([]),j=e([]),k=e(""),w=a((()=>m.value.length>0&&m.value[0].points.length>0));return p((e=>{if(e.data)try{const a=JSON.parse(decodeURIComponent(e.data));y.value=a;let t=[];if(a.trajectory?t="string"==typeof a.trajectory?JSON.parse(a.trajectory):a.trajectory:a.metrics&&a.metrics.trajectory&&(t="string"==typeof a.metrics.trajectory?JSON.parse(a.metrics.trajectory):a.metrics.trajectory),t&&t.length>0&&(m.value=[{points:t,color:"#20C997",width:4}],g.value=t[0].latitude,h.value=t[0].longitude,j.value=[{id:0,latitude:t[0].latitude,longitude:t[0].longitude,title:"起点",iconPath:"/static/location.png",width:20,height:20},{id:1,latitude:t[t.length-1].latitude,longitude:t[t.length-1].longitude,title:"终点",iconPath:"/static/location.png",width:20,height:20}]),a.evidence)if(Array.isArray(a.evidence)){const e=a.evidence.find((e=>"video"===e.type||e.url.endsWith(".mp4")));e&&(k.value=e.url)}else"string"==typeof a.evidence&&a.evidence.endsWith(".mp4")&&(k.value=a.evidence)}catch(a){console.error("Parse task detail failed",a)}})),(e,a)=>{const p=n,_=s,b=v,x=f;return i(),t(_,{class:"container"},{default:l((()=>[u(_,{class:"info-card"},{default:l((()=>[u(_,{class:"header"},{default:l((()=>[u(p,{class:"title"},{default:l((()=>[d(c(y.value.title),1)])),_:1}),u(p,{class:r(["status",y.value.status])},{default:l((()=>[d(c(y.value.statusText),1)])),_:1},8,["class"])])),_:1}),u(_,{class:"detail-row"},{default:l((()=>[u(p,{class:"label"},{default:l((()=>[d("任务类型:")])),_:1}),u(p,{class:"value"},{default:l((()=>[d(c("run"===y.value.type?"跑步":"体测"),1)])),_:1})])),_:1}),u(_,{class:"detail-row"},{default:l((()=>[u(p,{class:"label"},{default:l((()=>[d("截止时间:")])),_:1}),u(p,{class:"value"},{default:l((()=>[d(c(y.value.deadline),1)])),_:1})])),_:1}),y.value.description?(i(),t(_,{key:0,class:"detail-row"},{default:l((()=>[u(p,{class:"label"},{default:l((()=>[d("任务描述:")])),_:1}),u(p,{class:"value"},{default:l((()=>[d(c(y.value.description),1)])),_:1})])),_:1})):o("",!0),y.value.resultText?(i(),t(_,{key:1,class:"detail-row"},{default:l((()=>[u(p,{class:"label"},{default:l((()=>[d("考核结果:")])),_:1}),u(p,{class:"value highlight"},{default:l((()=>[d(c(y.value.resultText),1)])),_:1})])),_:1})):o("",!0)])),_:1}),w.value?(i(),t(_,{key:0,class:"map-card"},{default:l((()=>[u(p,{class:"section-title"},{default:l((()=>[d("运动轨迹")])),_:1}),u(b,{class:"map",latitude:g.value,longitude:h.value,polyline:m.value,markers:j.value,"enable-zoom":!0,"enable-scroll":!0},null,8,["latitude","longitude","polyline","markers"])])),_:1})):"completed"===y.value.status?(i(),t(_,{key:1,class:"no-data-card"},{default:l((()=>[u(p,{class:"tip"},{default:l((()=>[d("暂无轨迹数据")])),_:1})])),_:1})):o("",!0),k.value?(i(),t(_,{key:2,class:"video-card"},{default:l((()=>[u(p,{class:"section-title"},{default:l((()=>[d("视频记录")])),_:1}),u(x,{src:k.value,class:"video",controls:""},null,8,["src"])])),_:1})):o("",!0)])),_:1})}}},[["__scopeId","data-v-dbe36831"]]);export{y as default};
