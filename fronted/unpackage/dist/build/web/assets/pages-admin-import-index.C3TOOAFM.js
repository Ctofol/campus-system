import{c as e,w as t,i as s,o as a,d as n,e as l,aj as o,a as i,G as c,Y as r,H as d,J as u,p as m,ak as f,u as p}from"./index-DJkcSMuy.js";import{B as h}from"./request.DDN5gHc8.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=_({__name:"index",setup(_){const x=e=>{o({count:1,extension:[".xls",".xlsx"],success:t=>{t.tempFilePaths&&t.tempFilePaths.length>0&&C(t.tempFilePaths[0],e)}})},C=(e,t)=>{const s=i("token"),a="student"===t?"/admin/import/students":"/admin/import/teachers";c({title:"导入中..."}),r({url:h+a,filePath:e,name:"file",header:{Authorization:`Bearer ${s}`},success:e=>{d();try{const t=JSON.parse(e.data);if(200===e.statusCode){let e=`成功: ${t.success}, 失败: ${t.failed}`;t.errors&&t.errors.length>0&&(e+="\n\n失败详情:\n",t.errors.forEach((t=>{e+=`行${t.row} (${t.name}): ${t.error}\n`}))),u({title:"导入完成",content:e,showCancel:!1})}else u({title:"导入失败",content:t.detail||"未知错误",showCancel:!1})}catch(t){m({title:"解析响应失败",icon:"none"})}},fail:e=>{d(),m({title:"上传失败",icon:"none"}),console.error(e)}})},y=e=>{const t=i("token"),s=h+("student"===e?"/admin/import/template/students":"/admin/import/template/teachers");c({title:"准备下载..."}),f({url:s,header:{Authorization:`Bearer ${t}`},success:t=>{if(d(),200===t.statusCode){const s=document.createElement("a");s.href=t.tempFilePath,s.download="student"===e?"学生导入模板.xlsx":"教师导入模板.xlsx",document.body.appendChild(s),s.click(),document.body.removeChild(s)}else m({title:"下载失败: "+t.statusCode,icon:"none"})},fail:e=>{d(),m({title:"请求失败",icon:"none"}),console.error(e)}})};return(o,i)=>{const c=s,r=p;return a(),e(c,{class:"container"},{default:t((()=>[n(c,{class:"section"},{default:t((()=>[n(c,{class:"header"},{default:t((()=>[l("批量导入学生 (含模板下载)")])),_:1}),n(c,{class:"desc"},{default:t((()=>[l("请上传Excel文件，包含列：姓名, 手机号, 密码, 学号, 所属班级名称")])),_:1}),n(c,{class:"actions"},{default:t((()=>[n(r,{type:"primary",size:"mini",class:"btn",onClick:i[0]||(i[0]=e=>x("student"))},{default:t((()=>[l("选择文件并导入")])),_:1}),n(r,{type:"default",size:"mini",class:"btn",onClick:i[1]||(i[1]=e=>y("student"))},{default:t((()=>[l("下载模板")])),_:1})])),_:1})])),_:1}),n(c,{class:"section"},{default:t((()=>[n(c,{class:"header"},{default:t((()=>[l("批量导入教师 (含模板下载)")])),_:1}),n(c,{class:"desc"},{default:t((()=>[l("请上传Excel文件，包含列：姓名, 手机号, 密码, 工号")])),_:1}),n(c,{class:"actions"},{default:t((()=>[n(r,{type:"primary",size:"mini",class:"btn",onClick:i[2]||(i[2]=e=>x("teacher"))},{default:t((()=>[l("选择文件并导入")])),_:1}),n(r,{type:"default",size:"mini",class:"btn",onClick:i[3]||(i[3]=e=>y("teacher"))},{default:t((()=>[l("下载模板")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-79f45ecb"]]);export{x as default};
