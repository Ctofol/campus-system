import{r as e,z as a,c as l,w as s,i as t,o,d as u,e as n,q as c,t as d,s as r,G as i,b as p,m as f,p as _,I as m,v}from"./index-B3FfpJ1t.js";import{l as h}from"./request.CTIzMnE_.js";import{_ as g}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=g({__name:"login",setup(g){const b=e("student"),y=e(!1),k=e({account:"",password:""}),w=a((()=>k.value.account.length>0&&k.value.password.length>0)),x=async()=>{if(w.value&&(()=>{const{account:e,password:a}=k.value;return!(a.length<6&&(r({title:"密码长度不能少于6位",icon:"none"}),1))})()){y.value=!0;try{const e=await h({phone:k.value.account,password:k.value.password});if("admin"!==e.role&&e.role!==b.value)return r({title:"角色不匹配，请切换角色登录",icon:"none"}),void(y.value=!1);const a={userId:e.user_id,role:e.role,name:e.name,phone:k.value.account,schoolId:"10001",isPoliceSchool:!1};i("token",e.access_token),i("userInfo",a),i("userRole",e.role),r({title:"登录成功",icon:"success"}),setTimeout((()=>{"admin"===e.role?p({url:"/pages/admin/dashboard/index"}):"student"===b.value?p({url:"/pages/home/home"}):p({url:"/pages/teacher/home/home"})}),1e3)}catch(e){console.error("Login failed:",e)}finally{y.value=!1}}},C=()=>{f({url:"/pages/register/register"})},V=()=>{r({title:"请联系管理员重置密码",icon:"none"})};return(e,a)=>{const r=_,i=t,p=m,f=v;return o(),l(i,{class:"login-container"},{default:s((()=>[u(i,{class:"header-section"},{default:s((()=>[u(i,{class:"logo-circle"},{default:s((()=>[u(r,{class:"logo-text"},{default:s((()=>[n("校")])),_:1})])),_:1}),u(r,{class:"app-name"},{default:s((()=>[n("大学生运动健康管理平台")])),_:1}),u(r,{class:"app-sub-name"},{default:s((()=>[n("Professional Sports Management System")])),_:1})])),_:1}),u(i,{class:"login-card"},{default:s((()=>[u(i,{class:"role-tabs"},{default:s((()=>[u(i,{class:c(["role-tab",{active:"student"===b.value}]),onClick:a[0]||(a[0]=e=>b.value="student")},{default:s((()=>[u(r,null,{default:s((()=>[n("学生端")])),_:1})])),_:1},8,["class"]),u(i,{class:c(["role-tab",{active:"teacher"===b.value}]),onClick:a[1]||(a[1]=e=>b.value="teacher")},{default:s((()=>[u(r,null,{default:s((()=>[n("教师端")])),_:1})])),_:1},8,["class"])])),_:1}),u(i,{class:"form-area"},{default:s((()=>[u(i,{class:"input-group"},{default:s((()=>[u(r,{class:"input-label"},{default:s((()=>[n(d("student"===b.value?"学号 / 手机号":"工号 / 手机号"),1)])),_:1}),u(p,{class:"input-field",modelValue:k.value.account,"onUpdate:modelValue":a[2]||(a[2]=e=>k.value.account=e),placeholder:"student"===b.value?"请输入学号/手机号":"请输入工号/手机号","placeholder-class":"placeholder-style"},null,8,["modelValue","placeholder"])])),_:1}),u(i,{class:"input-group"},{default:s((()=>[u(r,{class:"input-label"},{default:s((()=>[n("密码")])),_:1}),u(p,{class:"input-field",modelValue:k.value.password,"onUpdate:modelValue":a[3]||(a[3]=e=>k.value.password=e),type:"password",placeholder:"请输入密码","placeholder-class":"placeholder-style"},null,8,["modelValue"])])),_:1}),u(f,{class:c(["submit-btn",{disabled:!w.value}]),onClick:x,loading:y.value},{default:s((()=>[n(" 登录 ")])),_:1},8,["class","loading"]),u(i,{class:"footer-links"},{default:s((()=>[u(r,{class:"link-text",onClick:C},{default:s((()=>[n("注册新账号")])),_:1}),u(r,{class:"divider"},{default:s((()=>[n("|")])),_:1}),u(r,{class:"link-text",onClick:V},{default:s((()=>[n("忘记密码？")])),_:1})])),_:1})])),_:1})])),_:1}),u(i,{class:"copyright"},{default:s((()=>[u(r,null,{default:s((()=>[n("Copyright © 2026 Campus Sports System")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-16e2e37a"]]);export{b as default};
