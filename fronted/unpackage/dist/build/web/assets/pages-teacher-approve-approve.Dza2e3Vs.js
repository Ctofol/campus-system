import{r as s,c as e,w as t,p as a,i as l,o as c,d as o,e as r,f as n,h as d,F as u,j as i,q as p,S as m,t as _,l as f,n as v,m as y,u as k}from"./index-DJkcSMuy.js";import{o as h}from"./uni-app.es.BbaSIkqw.js";import{i as g,j}from"./request.DDN5gHc8.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=C({__name:"approve",setup(C){const b=s([]),w=async()=>{try{const s=await g({page:1,size:20});s&&s.items&&(b.value=s.items)}catch(s){console.error(s),a({title:"加载待审批活动失败",icon:"none"})}};return h((()=>{w()})),(s,h)=>{const g=p,C=l,x=k,q=m;return c(),e(C,{class:"container"},{default:t((()=>[o(C,{class:"header"},{default:t((()=>[o(g,{class:"title"},{default:t((()=>[r("待审批活动")])),_:1})])),_:1}),o(q,{"scroll-y":"",class:"list"},{default:t((()=>[(c(!0),n(u,null,d(b.value,(s=>(c(),e(C,{class:"item",key:s.id,onClick:e=>(s=>{y({url:`/pages/teacher/approve/student-detail?studentId=${s.user_id}&studentName=${s.student_name}`})})(s)},{default:t((()=>[o(C,{class:"info"},{default:t((()=>[o(g,{class:"name"},{default:t((()=>[r(_(s.student_name),1)])),_:2},1024),o(C,{class:"desc-row"},{default:t((()=>["run"===s.type?(c(),e(g,{key:0,class:"desc"},{default:t((()=>{var e;return[r("跑步 - "+_((null==(e=s.metrics)?void 0:e.distance)?Number(s.metrics.distance).toFixed(2):0)+"km",1)]})),_:2},1024)):(c(),e(g,{key:1,class:"desc"},{default:t((()=>{var e;return[r("体测 - "+_((null==(e=s.metrics)?void 0:e.count)?s.metrics.count:0)+"次",1)]})),_:2},1024))])),_:2},1024),o(g,{class:"time"},{default:t((()=>[r(_(new Date(s.started_at).toLocaleString()),1)])),_:2},1024)])),_:2},1024),o(x,{class:"btn",onClick:f((e=>(async s=>{try{await j(s),a({title:"审批成功"}),w()}catch(e){console.error(e),a({title:"审批失败，请稍后重试",icon:"none"})}})(s.id)),["stop"]),disabled:"approved"===s.status||"completed"===s.status,style:v({backgroundColor:"approved"===s.status||"completed"===s.status?"#ccc":"#20C997"})},{default:t((()=>[r(_("approved"===s.status||"completed"===s.status?"已通过":"通过"),1)])),_:2},1032,["onClick","disabled","style"])])),_:2},1032,["onClick"])))),128)),0===b.value.length?(c(),e(C,{key:0,class:"empty"},{default:t((()=>[r("暂无待审批活动")])),_:1})):i("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-4a5ff35d"]]);export{b as default};
