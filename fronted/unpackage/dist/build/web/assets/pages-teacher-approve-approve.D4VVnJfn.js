import{r as s,c as e,w as t,s as a,i as l,o as c,d as o,e as r,j as n,k as d,F as u,f as i,p,S as m,t as _,l as f,n as v,m as y,v as k}from"./index-C5iLBQvu.js";import{o as g}from"./uni-app.es.BEWjhZNk.js";import{i as h,j}from"./request.BfbRFve_.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";const C=w({__name:"approve",setup(w){const C=s([]),b=async()=>{try{const s=await h({page:1,size:20});s&&s.items&&(C.value=s.items)}catch(s){console.error(s),a({title:"加载待审批活动失败",icon:"none"})}};return g((()=>{b()})),(s,g)=>{const h=p,w=l,x=k,z=m;return c(),e(w,{class:"container"},{default:t((()=>[o(w,{class:"header"},{default:t((()=>[o(h,{class:"title"},{default:t((()=>[r("待审批活动")])),_:1})])),_:1}),o(z,{"scroll-y":"",class:"list"},{default:t((()=>[(c(!0),n(u,null,d(C.value,(s=>(c(),e(w,{class:"item",key:s.id,onClick:e=>(s=>{y({url:`/pages/teacher/approve/student-detail?studentId=${s.user_id}&studentName=${s.student_name}`})})(s)},{default:t((()=>[o(w,{class:"info"},{default:t((()=>[o(h,{class:"name"},{default:t((()=>[r(_(s.student_name),1)])),_:2},1024),o(w,{class:"desc-row"},{default:t((()=>["run"===s.type?(c(),e(h,{key:0,class:"desc"},{default:t((()=>{var e;return[r("跑步 - "+_((null==(e=s.metrics)?void 0:e.distance)?Number(s.metrics.distance).toFixed(2):0)+"km",1)]})),_:2},1024)):(c(),e(h,{key:1,class:"desc"},{default:t((()=>{var e;return[r("体测 - "+_((null==(e=s.metrics)?void 0:e.count)?s.metrics.count:0)+"次",1)]})),_:2},1024))])),_:2},1024),o(h,{class:"time"},{default:t((()=>[r(_(new Date(s.started_at).toLocaleString()),1)])),_:2},1024)])),_:2},1024),o(x,{class:"btn",onClick:f((e=>(async s=>{try{await j(s),a({title:"审批成功"}),b()}catch(e){console.error(e),a({title:"审批失败，请稍后重试",icon:"none"})}})(s.id)),["stop"]),disabled:"approved"===s.status||"completed"===s.status,style:v({backgroundColor:"approved"===s.status||"completed"===s.status?"#ccc":"#20C997"})},{default:t((()=>[r(_("approved"===s.status||"completed"===s.status?"已通过":"通过"),1)])),_:2},1032,["onClick","disabled","style"])])),_:2},1032,["onClick"])))),128)),0===C.value.length?(c(),e(w,{key:0,class:"empty"},{default:t((()=>[r("暂无待审批活动")])),_:1})):i("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-4a5ff35d"]]);export{C as default};
