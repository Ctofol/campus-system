"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var x=Object.create;var m=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var w=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var L=(e,o,a,n)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of _(o))!v.call(e,s)&&s!==a&&m(e,s,{get:()=>o[s],enumerable:!(n=b(o,s))||n.enumerable});return e};var f=(e,o,a)=>(a=e!=null?x(y(e)):{},L(o||!e||!e.__esModule?m(a,"default",{value:e,enumerable:!0}):a,e));var d=w((B,p)=>{p.exports=Vue});var g=f(d());function h(e,o,...a){uni.__log__?uni.__log__(e,o,...a):console[e].apply(console,[...a,o])}var C=(e,o)=>{let a=e.__vccOpts||e;for(let[n,s]of o)a[n]=s;return a};var t=f(d()),k={page:{"":{flex:1,backgroundColor:"#f8f8f8",flexDirection:"column"}},header:{"":{paddingTop:60,paddingRight:20,paddingBottom:20,paddingLeft:20,backgroundColor:"#ffffff"}},title:{"":{fontSize:20,fontWeight:"bold"}},subtitle:{"":{fontSize:12,color:"#666666",marginTop:5}},"camera-box":{"":{width:"750rpx",height:"500rpx",backgroundColor:"#333333",marginTop:10,position:"relative",justifyContent:"center",alignItems:"center"}},"camera-placeholder":{"":{position:"absolute",top:"200rpx",left:0,width:"750rpx",alignItems:"center"}},"camera-view":{"":{width:"750rpx",height:"500rpx",position:"absolute",top:0,left:0}},"error-overlay":{"":{position:"absolute",top:0,left:0,width:"750rpx",height:"500rpx",backgroundColor:"rgba(0,0,0,0.8)",justifyContent:"center",alignItems:"center"}},"error-text":{"":{color:"#ff0000",fontSize:18,fontWeight:"bold",marginBottom:10}},"error-desc":{"":{color:"#ffffff",fontSize:14,marginBottom:5}},"log-box":{"":{flex:1,backgroundColor:"#333333",marginTop:10,marginRight:10,marginBottom:10,marginLeft:10,paddingTop:10,paddingRight:10,paddingBottom:10,paddingLeft:10,borderRadius:5}},"log-text":{"":{color:"#00ff00",fontSize:12,fontFamily:"monospace"}},"btn-group":{"":{paddingTop:10,paddingRight:10,paddingBottom:10,paddingLeft:10,backgroundColor:"#ffffff"}},btn:{"":{marginBottom:10,backgroundColor:"#007aff",borderRadius:5,height:44,justifyContent:"center",alignItems:"center"}},secondary:{"":{backgroundColor:"#999999"}}},S={data(){return{logs:`Ready...
`,ctx:null,devicePosition:"back",isAPIMissing:!1,isCustomBase:!1}},onLoad(){this.addLog("Page onLoad"),this.checkRuntime()},onReady(){this.addLog("Page onReady"),typeof uni.createCameraContext=="function"?(this.ctx=uni.createCameraContext(),this.addLog("Camera Context Created")):(this.addLog("Error: uni.createCameraContext is not a function"),this.isAPIMissing=!0,uni.showModal({title:"\u73AF\u5883\u5F02\u5E38",content:`\u68C0\u6D4B\u5230 uni.createCameraContext \u65B9\u6CD5\u7F3A\u5931\u3002

\u8FD9\u901A\u5E38\u662F\u56E0\u4E3A\u201C\u81EA\u5B9A\u4E49\u57FA\u5EA7\u201D\u672A\u5305\u542B Camera \u6A21\u5757\u3002

\u8BF7\u5728 HBuilderX \u83DC\u5355\u4E2D\u9009\u62E9\uFF1A
\u8FD0\u884C -> \u8FD0\u884C\u5230\u624B\u673A -> \u5236\u4F5C\u81EA\u5B9A\u4E49\u8C03\u8BD5\u57FA\u5EA7
(\u786E\u4FDD manifest \u5DF2\u52FE\u9009 Camera \u6A21\u5757)`,showCancel:!1}))},methods:{addLog(e){let o=new Date().toTimeString().split(" ")[0];this.logs=`[${o}] ${e}
`+this.logs,h("log","at pages/test/camera-min.nvue:91",e)},onError(e){this.addLog("Camera Error Event: "+JSON.stringify(e.detail))},onInitDone(e){this.addLog("Camera InitDone Event: "+JSON.stringify(e.detail))},checkRuntime(){this.isCustomBase=plus.runtime.isCustomRuntime;let e=uni.getSystemInfoSync();this.addLog("SysInfo: "+e.platform+" / "+e.system),this.addLog("AppID: "+e.appId),this.addLog("Runtime CustomBase: "+this.isCustomBase),this.isCustomBase||(this.addLog("WARNING: Running on Standard Base!"),uni.showToast({title:"\u8BF7\u5207\u6362\u5230\u81EA\u5B9A\u4E49\u57FA\u5EA7",icon:"none",duration:3e3}))},testSystemCamera(){this.addLog("\u5C1D\u8BD5\u8C03\u7528\u7CFB\u7EDF\u76F8\u673A..."),plus.camera.getCamera().captureImage(o=>{this.addLog("\u7CFB\u7EDF\u76F8\u673A\u62CD\u7167\u6210\u529F: "+o),uni.showToast({title:"\u786C\u4EF6\u6B63\u5E38",icon:"success"})},o=>{this.addLog("\u7CFB\u7EDF\u76F8\u673A\u5931\u8D25: "+o.message),uni.showModal({title:"\u76F8\u673A\u542F\u52A8\u5931\u8D25",content:"\u9519\u8BEF: "+o.message})},{filename:"_doc/camera/",index:1})},testPlusCamera(){try{let e=plus.camera.getCamera();if(this.addLog("Plus Camera Obj: "+(e?"OK":"NULL")),e){let o=e.supportedImageResolutions;this.addLog("Supported Res: "+JSON.stringify(o))}}catch(e){this.addLog("Plus Error: "+e.message)}},startPreviewManual(){this.ctx?(this.addLog("Calling startPreview..."),this.ctx.startPreview({success:()=>this.addLog("startPreview Success"),fail:e=>this.addLog("startPreview Fail: "+e.errMsg)})):this.addLog("No Camera Context")},toggleCamera(){this.devicePosition=this.devicePosition==="back"?"front":"back",this.addLog("Switched to: "+this.devicePosition)},goBack(){uni.navigateBack()}}};function I(e,o,a,n,s,r){let i=(0,t.resolveComponent)("button");return(0,t.openBlock)(),(0,t.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,t.createElementVNode)("view",{class:"page"},[(0,t.createElementVNode)("view",{class:"header"},[(0,t.createElementVNode)("u-text",{class:"title"},"Camera Debug V3"),(0,t.createElementVNode)("u-text",{class:"subtitle"},"\u7EA2\u5E95=\u5BB9\u5668, \u7EFF\u5E95=\u7EC4\u4EF6, \u753B\u9762=\u6B63\u5E38")]),(0,t.createElementVNode)("view",{class:"camera-box"},[(0,t.createElementVNode)("view",{class:"camera-placeholder"},[(0,t.createElementVNode)("u-text",{style:{color:"#666","font-size":"14px"}},"\u6444\u50CF\u5934\u533A\u57DF")]),(0,t.createElementVNode)("camera",{id:"myCamera",class:"camera-view",devicePosition:s.devicePosition,flash:"off",onError:o[0]||(o[0]=(...l)=>r.onError&&r.onError(...l)),onInitdone:o[1]||(o[1]=(...l)=>r.onInitDone&&r.onInitDone(...l)),style:{width:"750rpx",height:"500rpx","background-color":"transparent"}},null,40,["devicePosition"]),s.isAPIMissing?((0,t.openBlock)(),(0,t.createElementBlock)("view",{key:0,class:"error-overlay",style:{"background-color":"rgba(0,0,0,0.5)","pointer-events":"none"}},[(0,t.createElementVNode)("u-text",{class:"error-text",style:{"font-size":"14px",color:"#ff9900"}},"\u26A0\uFE0F Camera API \u672A\u5C31\u7EEA"),(0,t.createElementVNode)("u-text",{class:"error-desc",style:{"font-size":"12px"}},"\u8BF7\u5C1D\u8BD5\u5378\u8F7D App \u540E\u91CD\u88C5")])):(0,t.createCommentVNode)("",!0)]),(0,t.createElementVNode)("scroll-view",{class:"log-box",scrollY:"true"},[(0,t.createElementVNode)("u-text",{class:"log-text"},(0,t.toDisplayString)(s.logs),1)]),(0,t.createElementVNode)("view",{class:"btn-group"},[(0,t.createVNode)(i,{class:"btn",onClick:r.testSystemCamera},{default:(0,t.withCtx)(()=>[(0,t.createTextVNode)("1. \u8C03\u7528\u7CFB\u7EDF\u76F8\u673A (\u9A8C\u8BC1\u786C\u4EF6)")]),_:1},8,["onClick"]),(0,t.createVNode)(i,{class:"btn",onClick:r.startPreviewManual},{default:(0,t.withCtx)(()=>[(0,t.createTextVNode)("2. \u5F3A\u5236\u542F\u52A8\u9884\u89C8")]),_:1},8,["onClick"]),(0,t.createVNode)(i,{class:"btn",onClick:r.toggleCamera},{default:(0,t.withCtx)(()=>[(0,t.createTextVNode)("3. \u5207\u6362\u6444\u50CF\u5934")]),_:1},8,["onClick"]),(0,t.createVNode)(i,{class:"btn secondary",onClick:r.goBack},{default:(0,t.withCtx)(()=>[(0,t.createTextVNode)("\u8FD4\u56DE")]),_:1},8,["onClick"])])])])}var c=C(S,[["render",I],["styles",[k]]]);var u=plus.webview.currentWebview();if(u){let e=parseInt(u.id),o="pages/test/camera-min",a={};try{a=JSON.parse(u.__query__)}catch(s){}c.mpType="page";let n=Vue.createPageApp(c,{$store:getApp({allowDefault:!0}).$store,__pageId:e,__pagePath:o,__pageQuery:a});n.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...c.styles||[]])),n.mount("#root")}})();
